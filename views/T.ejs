<!DOCTYPE html>

<script src="/javascripts/fmtreeT.js"></script>
<link type="text/css" rel="stylesheet" href="/stylesheets/xtree.css">

<div class="container-fluid">
  <div class="row-fluid">
    <div  class="span12">
      <div class="tabbable">
        <ul class="nav nav-tabs" id="tabs">
          <li>
            <a data-toggle="tab" style="cursor:pointer">Feature Model</a>
          </li>
          <li  class="active">
            <a data-toggle="tab" style="cursor:pointer">Traceability</a>
          </li>
          <li>
            <a data-toggle="tab"  style="cursor:pointer">Configuration</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<style>
    div.c{padding-left:1%}
    div.left{float:left;width:20%;margin:6px;border:1px solid #c3c3c3;border-radius: 10px;}
    div.center{float:left;width:50%;margin:6px;}
    div.right{float:left;width:25%;margin:6px;}
    /*min-height: 500px;*/
    div.titles{
      text-align: center;
      font-size: 125%;
      font-weight: bold;
      margin-top: 12px;
      font-family: "David";
    }

    b{
      font-weight: bold ! important ;
      display: inline !important
    }

    .ui-accordion-header-icon.ui-icon.ui-icon-triangle-1-e{
      display: inline !important
    }

    .ui-accordion-header-icon.ui-icon.ui-icon-triangle-1-s{
      display: inline !important
    }

    div.ostitles{
      text-align: center;
      font-size: 115%;
      font-weight: bold;
      margin-top: 8px;
      font-family: "David";
    }

    .myh4 {
      font-family:"Calibri";
      font-size:125%;
    }

    h4{
      color: #000000
    }

    h5{
      font-weight: normal;
    }
    .myInside {
      border-top:1px solid #c3c3c3;
      overflow:auto;
      color: #000000;
      height: 32px; 
    }


    .myInsideA {
      border-top:1px solid #c3c3c3;
      overflow:auto;
      color: #000000;
      height: 32px; 
    }


    .myInsidePlus {
      border-top:1px solid #c3c3c3;
      overflow:auto;
      color: #000000;
      height: 32px; 

    }

    .focusBgColor{
      background-color: #c3c3c3;
    }

    .group { zoom: 1 }

    .depnInside{
      border-top:1px solid #c3c3c3;
    }

    .getFocus{
      border:1px solid #c3c3c3;
    }

    .GuardListStyle{float:right;margin-right:6px;margin-top:10px;display:none;}
    .GuardListStyleShow{float:right;margin-right:6px;margin-top:10px;display:block;}
</style>

<script type="text/javascript">
  var $seq_no=0;
  var $current_guard_id;
  var $current_accordion;
  var $index;
  var $current_operation;

  var $activityname;
  var $activitydescription;
  var $activityexecutor;
  var $activityvirtual;

  var guardname=$("#guardname");
  var $tracerules;
  var $selfName;
  var $operation_position;
  var $str;

  var $TDLType;

  var $mark;

  function update_pageT()
  {
    window.location.href("/T");
  }

  $(function(){
    $elementdepency="<%=elementdepencys%>";
     var rad_elm = $('input[name^="TDLType"]'),rad_last;
     var sel_elm = $('select[class^="TDLType"]'),sel_last;
    /* sel_elm.change(function() {
            if (sel_last != this) {
                sel_last = this;
                sel_elm.each(function() {
                    (sel_last != this) && (this.selectedIndex = -1);
                });
            }
            rad_elm.get(0).checked=false;
        });*/
      rad_elm.change(function(){
        if(rad_last != this)
        {
          rad_last=this;
          
          //alert($(this).next()[0].tagName);
          rad_elm.each(function(){

            if(rad_last!=this){
             $(this).parent().find("select").attr('disabled',true);
            }
          })
          $(this).parent().find("select").attr('disabled',false);
        }
     })
      $("#guardNameShow").mouseover(function(){
        $(this).find("i").show();
      })

      $("#guardNameShow").mouseout(function(){
        $(this).find("i").hide();
      })

      $(".myInsideA").mouseover(function(){
          $(this).children().show();
          $(this).find(".icon-chevron-right").hide();
      })
      $(".myInsideA").mouseout(function(){
          $(this).children().hide();
          $(this).find(".icon-chevron-right").show();
        
      })

      $("h4").mouseover(function(){
          $(this).children().show();
      })
      $("h4").mouseout(function(){
          $(this).children().hide();
      })


      var $OldActivityName;
      var $OldActivityDescription;
      var $OldActivityExecutor;

      var $ActivityName;
      var $ActivityDescription;
      var $ActivityExecutor;

       

      $(".icon-pencil.editOperation.Activity").click(function(){
          $OldActivityName=$(this).parent().find('input').val();
          $OldActivityDescription=$(this).parent().parent().parent().find('textarea').text();
          $OldActivityExecutor=$(this).parent().parent().parent().find("option:selected").val();
         
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('input').attr("readonly",false);
          $(this).find('textarea').attr("readonly",false);
          $(this).find('select').attr("disabled",false);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.Activity").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_editactivity").val();
          $ActivityName=$(this).parent().find('input').val();
          $ActivityDescription=$(this).parent().parent().parent().find('textarea').val();
          $ActivityExecutor=$(this).parent().parent().parent().find("option:selected").val();
         
        jQuery.each($(this).parent().parent().parent(),function(){
           $(this).find('input').attr("readonly",true);
           $(this).find('textarea').attr("readonly",true);

   
            /*$("b").each(function(i){
              if($(this).html()==$OldActivityExecutor){
                 $(this).html($ActivityExecutor);
              }
            })*/
        })

        //$(this).parent().parent().parent().('input').attr("readonly",false);

        $("b").each(function(i){
          if($(this).html()==$OldActivityName){
            $(this).html($ActivityName);
          }
        
        })

        $("option").each(function(i){
          
          var spl=$(this).val().split(".");
          if(spl.length===2 && spl[1]==$OldActivityName){

            $(this).val(spl[0]+"."+$ActivityName);
            $(this).html($ActivityName);
          }
          
        })
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          var temp_operation=$(this).attr("id").split(" ");
          var temps="";
          for(temp in temp_operation)
          {
            if(temps!="")
              temps=temps+" ";
            
            if(temp_operation[temp]==$OldActivityName)
            {
              temp_operation[temp]=$ActivityName;
            }
            temps=temps+temp_operation[temp];

          }
          $(this).attr("id",temps);
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

         var $nameMark;
         var $DescriptionMark;
         var $ExecutorMark;
         if($ActivityName!==$OldActivityName)
            $nameMark=true;
          else
            $nameMark=false;
         if($ActivityDescription!==$OldActivityDescription)
            $DescriptionMark=true;
          else
            $DescriptionMark=false;
         if($ActivityExecutor!=$OldActivityExecutor)
            $ExecutorMark=true;
          else
            $ExecutorMark=false;

         if($ActivityName!==$OldActivityName || $ActivityDescription!==$OldActivityDescription||$ActivityExecutor!=$OldActivityExecutor){
          $.ajax({
            type: "POST",
            url: "/EditActivity",
            async:false,
            data: {
              nameMark:$nameMark,
              descriptionMark:$DescriptionMark,
              executorMark:$ExecutorMark,
              user:"<%=tracerules[0].user%>",
              id:$hidden_fields,
              activityname:$ActivityName,
              activitydescription:$ActivityDescription,
              activityexecutor:$ActivityExecutor,
              oldactivityname:$OldActivityName,
              oldactivitydescription:$OldActivityDescription,
              oldactivityexecutor:$OldActivityExecutor,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 
        }
        
      })


      var $OldUseCaseName;
      var $OldUseCaseDescription;

      var $UseCaseName;
      var $UseCaseDescription;

      $(".icon-pencil.editOperation.UseCase").click(function(){

          $OldUseCaseName=$(this).parent().find('input').val();
          $OldUseCaseDescription=$(this).parent().parent().parent().find('textarea').text();
          
        jQuery.each($(this).parent().parent().parent(),function(){
          
          $(this).find('input').attr("readonly",false);
          $(this).find('textarea').attr("readonly",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.UseCase").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_editusecase").val();
          $UseCaseName=$(this).parent().find('input').val();
          $UseCaseDescription=$(this).parent().parent().parent().find('textarea').val();
          
        jQuery.each($(this).parent().parent().parent(),function(){
           $(this).find('input').attr("readonly",true);
           $(this).find('textarea').attr("readonly",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
        $("b").each(function(i){
          if($(this).html()==$OldUseCaseName){
            $(this).html($UseCaseName);
          }
        })

        $("option").each(function(i){
          
          var spl=$(this).val().split(".");
          if(spl.length===2 && spl[1]==$OldUseCaseName){

            $(this).val(spl[0]+"."+$UseCaseName);
            $(this).html($UseCaseName);
          }
          
        })
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          var temp_operation=$(this).attr("id").split(" ");
          var temps="";
          for(temp in temp_operation)
          {
            if(temps!="")
              temps=temps+" ";
            
            if(temp_operation[temp]==$OldUseCaseName)
            {
              temp_operation[temp]=$UseCaseName;
            }
            temps=temps+temp_operation[temp];

          }
          $(this).attr("id",temps);
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

         var $nameMark;
         var $DescriptionMark;
         if($UseCaseName!==$OldUseCaseName)
            $nameMark=true;
          else
            $nameMark=false;
         if($UseCaseDescription!==$OldUseCaseDescription)
            $DescriptionMark=true;
          else
            $DescriptionMark=false;
          console.log("1");
          

         if($UseCaseName!==$OldUseCaseName || $UseCaseDescription!==$OldUseCaseDescription){
          $.ajax({
            type: "POST",
            url: "/EditUseCase",
            async:false,
            data: {
              nameMark:$nameMark,
              descriptionMark:$DescriptionMark,
              user:"<%=tracerules[0].user%>",
              id:$hidden_fields,
              usecasename:$UseCaseName,
              usecasedescription:$UseCaseDescription,
              oldusecasename:$OldUseCaseName,
              oldusecasedescription:$OldUseCaseDescription,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 
        }
        console.log("2");
        
      })
       
       var $OldDecisionName;
       var $OldDecisionDescription;
       var $OldDecisionExecutor;

       var $DecisionName;
       var $DecisionDescription;
       var $DecisionExecutor;

      $(".icon-pencil.editOperation.Decision").click(function(){
          $OldDecisionName=$(this).parent().find('input').val();
          $OldDecisionDescription=$(this).parent().parent().parent().find('textarea').text();
          $OldDecisionExecutor=$(this).parent().parent().parent().find("option:selected").val();
         
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('input').attr("readonly",false);
          $(this).find('textarea').attr("readonly",false);
          $(this).find('select').attr("disabled",false);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.Decision").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_editdecision").val();
        
          $DecisionName=$(this).parent().find('input').val();
          $DecisionDescription=$(this).parent().parent().parent().find('textarea').val();
          $DecisionExecutor=$(this).parent().parent().parent().find("option:selected").val();

        jQuery.each($(this).parent().parent().parent(),function(){
           $(this).find('input').attr("readonly",true);
           $(this).find('textarea').attr("readonly",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
        $("b").each(function(i){
          if($(this).html()==$OldDecisionName){
            $(this).html($DecisionName);
          }
           if($(this).html()==$OldDecisionExecutor){
            $(this).html($DecisionExecutor);
          }
        })

        $("option").each(function(i){
          
          var spl=$(this).val().split(".");
          if(spl.length===2 && spl[1]==$OldDecisionName){

            $(this).val(spl[0]+"."+$DecisionName);
            $(this).html($DecisionName);
          }
          
        })
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          var temp_operation=$(this).attr("id").split(" ");
          var temps="";
          for(temp in temp_operation)
          {
            if(temps!="")
              temps=temps+" ";
            
            if(temp_operation[temp]==$OldDecisionName)
            {
              temp_operation[temp]=$DecisionName;
            }
            temps=temps+temp_operation[temp];

          }
          $(this).attr("id",temps);
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

         var $nameMark;
         var $DescriptionMark;
         var $ExecutorMark;
         if($DecisionName!==$OldDecisionName)
            $nameMark=true;
          else
            $nameMark=false;
         if($DecisionDescription!==$OldDecisionDescription)
            $DescriptionMark=true;
          else
            $DescriptionMark=false;
         if($DecisionExecutor!=$OldDecisionExecutor)
            $ExecutorMark=true;
          else
            $ExecutorMark=false;

         if($DecisionName!==$OldDecisionName || $DecisionDescription!==$OldDecisionDescription||$DecisionExecutor!=$OldDecisionExecutor){
          $.ajax({
            type: "POST",
            url: "/EditDecision",
            async:false,
            data: {
              nameMark:$nameMark,
              descriptionMark:$DescriptionMark,
              executorMark:$ExecutorMark,
              user:"<%=tracerules[0].user%>",
              id:$hidden_fields,
              decisionname:$DecisionName,
              decisiondescription:$DecisionDescription,
              decisionexecutor:$DecisionExecutor,
              olddecisionname:$OldDecisionName,
              olddecisiondescription:$OldDecisionDescription,
              olddecisionexecutor:$OldDecisionExecutor,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 
        }
      })

      var $OldConditionName;
      var $OldConditionDescription;

      var $ConditionName;
      var $ConditionDescription;

      $(".icon-pencil.editOperation.Condition").click(function(){
         $OldConditionName=$(this).parent().find('input').val();
         $OldConditionDescription=$(this).parent().parent().parent().find('textarea').text();
          
        jQuery.each($(this).parent().parent().parent(),function(){
          
          $(this).find('input').attr("readonly",false);
          $(this).find('textarea').attr("readonly",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.Condition").click(function(){
           var $hidden_fields=$(this).parent().parent().parent().find("#hidden_editcondition").val();
          $ConditionName=$(this).parent().find('input').val();
          $ConditionDescription=$(this).parent().parent().parent().find('textarea').val();
          
        jQuery.each($(this).parent().parent().parent(),function(){
           $(this).find('input').attr("readonly",true);
           $(this).find('textarea').attr("readonly",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
        $("b").each(function(i){
          if($(this).html()==$OldConditionName){
            $(this).html($ConditionName);
          }
        })

        $("option").each(function(i){
          
          var spl=$(this).val().split(".");
          if(spl.length===2 && spl[1]==$OldConditionName){

            $(this).val(spl[0]+"."+$ConditionName);
            $(this).html($ConditionName);
          }
          
        })
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          var temp_operation=$(this).attr("id").split(" ");
          var temps="";
          for(temp in temp_operation)
          {
            if(temps!="")
              temps=temps+" ";
            
            if(temp_operation[temp]==$OldConditionName)
            {
              temp_operation[temp]=$ConditionName;
            }
            temps=temps+temp_operation[temp];

          }
          $(this).attr("id",temps);
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

         var $nameMark;
         var $DescriptionMark;
         if($ConditionName!==$OldConditionName)
            $nameMark=true;
          else
            $nameMark=false;
         if($ConditionDescription!==$OldConditionDescription)
            $DescriptionMark=true;
          else
            $DescriptionMark=false;
          console.log("1");
         

         if($ConditionName!==$OldConditionName || $ConditionDescription!==$OldConditionDescription){
          $.ajax({
            type: "POST",
            url: "/EditCondition",
            async:false,
            data: {
              nameMark:$nameMark,
              descriptionMark:$DescriptionMark,
              user:"<%=tracerules[0].user%>",
              id:$hidden_fields,
              conditionname:$ConditionName,
              conditiondescription:$ConditionDescription,
              oldconditionname:$OldConditionName,
              oldconditiondescription:$OldConditionDescription,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);
              console.log("edit condition");

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 
        }
       
      })

      $(".icon-pencil.editOperation.InsertBetween").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertBetween").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

        var $OldTarAct,$OldPreAct,$OldUseCase;
        $(".icon-pencil.editOperation.insertactafterpre").click(function(){
          
          $OldTarAct=$(this).parent().find(".InterBetTar").find("option:selected").val();
          $OldPreAct=$(this).parent().parent().find(".InterBetPre").find("option:selected").val();
          $OldUseCase=$(this).parent().parent().find(".InterBetUseCase").find("option:selected").val();
          //alert($OldTarAct+" "+$OldPreAct+" "+$OldUseCase);
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.insertactafterpre").click(function(){
         var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertactafterpre").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
           var $editTartAct=$(this).parent().find(".InterBetTar").find("option:selected").val();
           var $editPreAct=$(this).parent().parent().find(".InterBetPre").find("option:selected").val();
           var $editUseCase=$(this).parent().parent().find(".InterBetUseCase").find("option:selected").val();
         var $nums=0;
        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++;
          if($nums==1&&$(this).html()==$OldTarAct.split(".")[1]){
            $(this).html($editTartAct.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldPreAct.split(".")[1]){
            $(this).html($editPreAct.split(".")[1]);
          }
           if($nums==3&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($editUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$editTartAct.split(".")[1]+" after "+$editPreAct.split(".")[1]+" in "+$editUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
        console.log("guardID:"+$("#hidden_insertactafterpre_guardID").val());
         
         $(this).css("display","none");
         $(this).siblings().show();
          
          $.ajax({
            type: "POST",
            url: "/EditInsertActAfterPre",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertactafterpre_guardID").val(),
              editTartAct:$editTartAct,
              editPreAct:$editPreAct,
              editUseCase:$editUseCase,
              oldTarAct:$OldTarAct,
              oldPreAct:$OldPreAct,
              oldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$("#hidden_insertactafterpre_guardID").val(),
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })

          var $OldPostAct;
        $(".icon-pencil.editOperation.insertActBeforePost").click(function(){
          
          $OldTarAct=$(this).parent().find(".InterBetTar").find("option:selected").val();
          $OldPostAct=$(this).parent().parent().find(".InterBetPre").find("option:selected").val();
          $OldUseCase=$(this).parent().parent().find(".InterBetUseCase").find("option:selected").val();
          //alert($OldTarAct+" "+$OldPostAct+" "+$OldUseCase);
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.insertActBeforePost").click(function(){
         var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertActBeforePost").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
           var $editTartAct=$(this).parent().find(".InterBetTar").find("option:selected").val();
           var $editPostAct=$(this).parent().parent().find(".InterBetPre").find("option:selected").val();
           var $editUseCase=$(this).parent().parent().find(".InterBetUseCase").find("option:selected").val();
         var $nums=0;
        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++;
          if($nums==1&&$(this).html()==$OldTarAct.split(".")[1]){
            $(this).html($editTartAct.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldPostAct.split(".")[1]){
            $(this).html($editPostAct.split(".")[1]);
          }
           if($nums==3&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($editUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$editTartAct.split(".")[1]+" before "+$editPostAct.split(".")[1]+" in "+$editUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

          $.ajax({
            type: "POST",
            url: "/EditInsertActBeforePost",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertActBeforePost_guardID").val(),
              editTartAct:$editTartAct,
              editPostAct:$editPostAct,
              editUseCase:$editUseCase,
              oldTarAct:$OldTarAct,
              oldPostAct:$OldPostAct,
              oldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$("#hidden_insertActBeforePost_guardID").val(),
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })
        var $OldDec,$OldCon;
       $(".icon-pencil.editOperation.insertActAfterDecCon").click(function(){
          
          $OldTarAct=$(this).parent().find(".InterAfterDecConAct").find("option:selected").val();
          $OldDec=$(this).parent().parent().find(".InterAfterDecConDec").find("option:selected").val();
          $OldCon=$(this).parent().parent().find(".InterAfterDecConCon").find("option:selected").val();
          $OldUseCase=$(this).parent().parent().find(".InterAfterDecConUseCase").find("option:selected").val();
          //alert($OldTarAct+" "+$OldPostAct+" "+$OldUseCase);
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.insertActAfterDecCon").click(function(){
         var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertActAfterDecCon").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
           var $editTartAct=$(this).parent().find(".InterAfterDecConAct").find("option:selected").val();
           var $editDec=$(this).parent().parent().find(".InterAfterDecConDec").find("option:selected").val();
           var $editCon=$(this).parent().parent().find(".InterAfterDecConCon").find("option:selected").val();
           var $editUseCase=$(this).parent().parent().find(".InterAfterDecConUseCase").find("option:selected").val();
         var $nums=0;
        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++;
          if($nums==1&&$(this).html()==$OldTarAct.split(".")[1]){
            $(this).html($editTartAct.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldDec.split(".")[1]){
            $(this).html($editDec.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldCon.split(".")[1]){
            $(this).html($editCon.split(".")[1]);
          }
           if($nums==4&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($editUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$editTartAct.split(".")[1]+" after "+$editDec.split(".")[1]+" , "+$editCon.split(".")[1]+" in "+$editUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

          $.ajax({
            type: "POST",
            url: "/EditInterAfterDecCon",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertActAfterDecCon_guardID").val(),
              editTartAct:$editTartAct,
              editDec:$editDec,
              editCon:$editCon,
              editUseCase:$editUseCase,
              oldTarAct:$OldTarAct,
              oldDec:$OldDec,
              oldCon:$OldCon,
              oldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$("#hidden_insertActAfterDecCon_guardID").val(),
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })
        var $OldAct;
       $(".icon-pencil.editOperation.insertActBeforeActCon").click(function(){
          
          $OldTarAct=$(this).parent().find(".InterBeforeActConTar").find("option:selected").val();
          $OldAct=$(this).parent().parent().find(".InterBeforeActConAct").find("option:selected").val();
          $OldCon=$(this).parent().parent().find(".InterBeforeActConCon").find("option:selected").val();
          $OldUseCase=$(this).parent().parent().find(".InterBeforeActConUseCase").find("option:selected").val();
          //alert($OldTarAct+" "+$OldPostAct+" "+$OldUseCase);
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.insertActBeforeActCon").click(function(){
         var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertActBeforeActCon").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
           var $editTartAct=$(this).parent().find(".InterBeforeActConTar").find("option:selected").val();
           var $editAct=$(this).parent().parent().find(".InterBeforeActConAct").find("option:selected").val();
           var $editCon=$(this).parent().parent().find(".InterBeforeActConCon").find("option:selected").val();
           var $editUseCase=$(this).parent().parent().find(".InterBeforeActConUseCase").find("option:selected").val();
         var $nums=0;
        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++;
          if($nums==1&&$(this).html()==$OldTarAct.split(".")[1]){
            $(this).html($editTartAct.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldAct.split(".")[1]){
            $(this).html($editAct.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldCon.split(".")[1]){
            $(this).html($editCon.split(".")[1]);
          }
           if($nums==4&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($editUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$editTartAct.split(".")[1]+" before "+$editAct.split(".")[1]+" , "+$editCon.split(".")[1]+" in "+$editUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

          $.ajax({
            type: "POST",
            url: "/EditInterBeforeActConCon",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertActBeforeActCon_guardID").val(),
              editTartAct:$editTartAct,
              editAct:$editAct,
              editCon:$editCon,
              editUseCase:$editUseCase,
              oldTarAct:$OldTarAct,
              oldAct:$OldAct,
              oldCon:$OldCon,
              oldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$("#hidden_insertActBeforeActCon_guardID").val(),
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })


/*
      $(".icon-ok.editOperation.Activity").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_editactivity").val();
        console.log($hidden_fields+"lalalalalalalal");
          $ActivityName=$(this).parent().find('input').val();
          $ActivityDescription=$(this).parent().parent().parent().find('textarea').val();
          $ActivityExecutor=$(this).parent().parent().parent().find("option:selected").val();

        jQuery.each($(this).parent().parent().parent(),function(){
           $(this).find('input').attr("readonly",true);
           $(this).find('textarea').attr("readonly",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
        $("b").each(function(i){
          if($(this).html()==$OldActivityName){
            $(this).html($ActivityName);
          }
           if($(this).html()==$OldActivityExecutor){
            $(this).html($ActivityExecutor);
          }
        })

        $("option").each(function(i){
          
          var spl=$(this).val().split(".");
          if(spl.length===2 && spl[1]==$OldActivityName){

            $(this).val(spl[0]+"."+$ActivityName);
            $(this).html($ActivityName);
          }
          
        })
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          var temp_operation=$(this).attr("id").split(" ");
          var temps="";
          for(temp in temp_operation)
          {
            if(temps!="")
              temps=temps+" ";
            
            if(temp_operation[temp]==$OldActivityName)
            {
              temp_operation[temp]=$ActivityName;
            }
            temps=temps+temp_operation[temp];

          }
          $(this).attr("id",temps);
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

         var $nameMark;
         var $DescriptionMark;
         var $ExecutorMark;
         if($ActivityName!==$OldActivityName)
            $nameMark=true;
          else
            $nameMark=false;
         if($ActivityDescription!==$OldActivityDescription)
            $DescriptionMark=true;
          else
            $DescriptionMark=false;
         if($ActivityExecutor!=$OldActivityExecutor)
            $ExecutorMark=true;
          else
            $ExecutorMark=false;

         if($ActivityName!==$OldActivityName || $ActivityDescription!==$OldActivityDescription||$ActivityExecutor!=$OldActivityExecutor){
          $.ajax({
            type: "POST",
            url: "/EditActivity",
            async:false,
            data: {
              nameMark:$nameMark,
              descriptionMark:$DescriptionMark,
              executorMark:$ExecutorMark,
              user:"<%=tracerules[0].user%>",
              id:$hidden_fields,
              activityname:$ActivityName,
              activitydescription:$ActivityDescription,
              activityexecutor:$ActivityExecutor,
              oldactivityname:$OldActivityName,
              oldactivitydescription:$OldActivityDescription,
              oldactivityexecutor:$OldActivityExecutor,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$hidden_fields,
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 
        }

      })

*/
      var $OldTarDec;
      var $OldPreAct;
      var $OldMainCon;
      var $OldSBCon;
      var $OldInsertAct;
      var $OldInsertTarAct;

       $(".icon-pencil.editOperation.InsertAfterDecCon").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecAfterActDec").find("option:selected").val();
          $OldPreAct=$(this).parent().parent().find(".InsertDecAfterActPreAct").find("option:selected").val();
          $OldMainCon=$(this).parent().parent().find(".InsertDecAfterActMainCon").find("option:selected").val();
          $OldSBCon=$(this).parent().parent().find(".InsertDecAfterActSupCon").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecAfterActInserAct").find("option:selected").val();
          $OldInsertTarAct=$(this).parent().parent().find(".InsertDecAfterActTarAct").find("option:selected").val(); 
          $OldUseCase=$(this).parent().parent().find(".InsertDecAfterActUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertAfterDecCon").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
      
      $(".icon-pencil.editOperation.InsertDecBeforeActWith").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertDecBeforeActWith").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

       $(".icon-pencil.editOperation.InsertBeforeActCon").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertBeforeActCon").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-pencil.editOperation.InsertDecBeforeActCon").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertDecBeforeActCon").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
      $(".icon-pencil.editOperation.InsertDecBeforeAct").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertDecBeforeAct").click(function(){
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      
    

      $(".icon-pencil.editOperation.InsertDecAfterAct").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecAfterActDec").find("option:selected").val();
          $OldPreAct=$(this).parent().parent().find(".InsertDecAfterActPreAct").find("option:selected").val();
          $OldMainCon=$(this).parent().parent().find(".InsertDecAfterActMainCon").find("option:selected").val();
          $OldSBCon=$(this).parent().parent().find(".InsertDecAfterActSupCon").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecAfterActInserAct").find("option:selected").val();
          $OldInsertTarAct=$(this).parent().parent().find(".InsertDecAfterActTarAct").find("option:selected").val(); 
          $OldUseCase=$(this).parent().parent().find(".InsertDecAfterActUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })

      $(".icon-ok.editOperation.InsertDecAfterAct").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertDecAfterAct").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
          
           var $EditTarDec=$(this).parent().find(".InsertDecAfterActDec").find("option:selected").val();
           var $EditPreAct=$(this).parent().parent().find(".InsertDecAfterActPreAct").find("option:selected").val();
           var $EditMainCon=$(this).parent().parent().find(".InsertDecAfterActMainCon").find("option:selected").val();
           var $EditSBCon=$(this).parent().parent().find(".InsertDecAfterActSupCon").find("option:selected").val();
           var $EditInsertAct=$(this).parent().parent().find(".InsertDecAfterActInserAct").find("option:selected").val();
           var $EditInsertTarAct=$(this).parent().parent().find(".InsertDecAfterActTarAct").find("option:selected").val(); 
           var $EditUseCase=$(this).parent().parent().find(".InsertDecAfterActUseCase").find("option:selected").val();

         var $nums=0;

        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++; console.log($nums+":"+$(this).html());
          if($nums==1&&$(this).html()==$OldTarDec.split(".")[1]){
            $(this).html($EditTarDec.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldPreAct.split(".")[1]){
            $(this).html($EditPreAct.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldMainCon.split(".")[1]){
            $(this).html($EditMainCon.split(".")[1]);
          }
          if($nums==4&&$(this).html()==$OldSBCon.split(".")[1]){
            $(this).html($EditSBCon.split(".")[1]);
          }
          if($nums==5&&$(this).html()==$OldInsertAct.split(".")[1]){
            $(this).html($EditInsertAct.split(".")[1]);
          }
          if($nums==6&&$(this).html()==$OldInsertTarAct.split(".")[1]){
            $(this).html($EditInsertTarAct.split(".")[1]);
          }
          if($nums==7&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($EditUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$EditTarDec.split(".")[1]+" after "+$EditPreAct.split(".")[1]+" with ( "+$EditMainCon.split(".")[1]+" ),( "+$EditSBCon.split(".")[1]+" , ";
          if($EditInsertAct!="0")
           $tempname=$tempname+$EditInsertAct.split(".")[1]+" , "
          $tempname=$tempname+$EditInsertTarAct.split(".")[1]+" ) in "+$EditUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

          $.ajax({
            type: "POST",
            url: "/EditInsertDecAfterAct",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertDecAfterAct_guardID").val(),
              EditTarDec:$EditTarDec,
              EditPreAct:$EditPreAct,
              EditMainCon:$EditMainCon,
              EditSBCon:$EditSBCon,
              EditInsertAct:$EditInsertAct,
              EditInsertTarAct:$EditInsertTarAct,
              EditUseCase:$EditUseCase,
              OldTarDec:$OldTarDec,
              OldPreAct:$OldPreAct,
              OldMainCon:$OldMainCon,
              OldSBCon:$OldSBCon,
              OldInsertAct:$OldInsertAct,
              OldInsertTarAct:$OldInsertTarAct,
              OldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$("#hidden_insertDecAfterAct_guardID").val(),
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })
      var $OldInsertDec,$OldInsertCon;
      $(".icon-pencil.editOperation.insertDecAfterDecCon").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecAfterDecConDec").find("option:selected").val();
          $OldInsertDec=$(this).parent().parent().find(".InsertDecAfterDecConInserDec").find("option:selected").val();
          $OldInsertCon=$(this).parent().parent().find(".InsertDecAfterDecConInserCon").find("option:selected").val();
          $OldMainCon=$(this).parent().parent().find(".InsertDecAfterDecConMainCon").find("option:selected").val();
          $OldSBCon=$(this).parent().parent().find(".InsertDecAfterDecConSupCon").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecAfterDecConInserAct").find("option:selected").val();
          $OldInsertTarAct=$(this).parent().parent().find(".InsertDecAfterDecConTarAct").find("option:selected").val(); 
          $OldUseCase=$(this).parent().parent().find(".InsertDecAfterDecConUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
  
      var $EditInsertDec,$EditInsertCon;
      $(".icon-ok.editOperation.insertDecAfterDecCon").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertDecAfterDecCon").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
          
          $EditTarDec=$(this).parent().find(".InsertDecAfterDecConDec").find("option:selected").val();
          $EditInsertDec=$(this).parent().parent().find(".InsertDecAfterDecConInserDec").find("option:selected").val();
          $EditInsertCon=$(this).parent().parent().find(".InsertDecAfterDecConInserCon").find("option:selected").val();
          $EditMainCon=$(this).parent().parent().find(".InsertDecAfterDecConMainCon").find("option:selected").val();
          $EditSBCon=$(this).parent().parent().find(".InsertDecAfterDecConSupCon").find("option:selected").val();
          $EditInsertAct=$(this).parent().parent().find(".InsertDecAfterDecConInserAct").find("option:selected").val();
          $EditInsertTarAct=$(this).parent().parent().find(".InsertDecAfterDecConTarAct").find("option:selected").val(); 
          $EditUseCase=$(this).parent().parent().find(".InsertDecAfterDecConUseCase").find("option:selected").val();

         var $nums=0;

        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++; console.log($nums+":"+$(this).html());
          if($nums==1&&$(this).html()==$OldTarDec.split(".")[1]){
            $(this).html($EditTarDec.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldInsertDec.split(".")[1]){
            $(this).html($EditInsertDec.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldInsertCon.split(".")[1]){
            $(this).html($EditInsertCon.split(".")[1]);
          }
          if($nums==4&&$(this).html()==$OldMainCon.split(".")[1]){
            $(this).html($EditMainCon.split(".")[1]);
          }
          if($nums==5&&$(this).html()==$OldSBCon.split(".")[1]){
            $(this).html($EditSBCon.split(".")[1]);
          }
          if($nums==6&&$(this).html()==$OldInsertAct.split(".")[1]){
            $(this).html($EditInsertAct.split(".")[1]);
          }
          if($nums==7&&$(this).html()==$OldInsertTarAct.split(".")[1]){
            $(this).html($EditInsertTarAct.split(".")[1]);
          }
          if($nums==8&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($EditUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$EditTarDec.split(".")[1]+" after ( "+$EditInsertDec.split(".")[1]+" , "+$EditInsertCon.split(".")[1]+" )"+" with ( "+$EditMainCon.split(".")[1]+" ),( "+$EditSBCon.split(".")[1]+" , "+$EditInsertAct.split(".")[1]+" , "+$EditInsertTarAct.split(".")[1]+" ) in "+$EditUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();
         
          $.ajax({
            type: "POST",
            url: "/EditInsertDecAfterDecCon",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertDecAfterDecCon_guardID").val(),
              EditTarDec:$EditTarDec,
              EditInsertDec:$EditInsertDec,
              EditInsertCon:$EditInsertCon,
              EditMainCon:$EditMainCon,
              EditSBCon:$EditSBCon,
              EditInsertAct:$EditInsertAct,
              EditInsertTarAct:$EditInsertTarAct,
              EditUseCase:$EditUseCase,
              OldTarDec:$OldTarDec,
              OldInsertDec:$OldInsertDec,
              OldInsertCon:$OldInsertCon,
              OldMainCon:$OldMainCon,
              OldSBCon:$OldSBCon,
              OldInsertAct:$OldInsertAct,
              OldInsertTarAct:$OldInsertTarAct,
              OldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$("#hidden_insertDecAfterDecCon_guardID").val(),
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss!!!");
              alert(typeof(a));
            }
          });  

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })

        var $OldCon1,$OldCon2,$OldTart1,$OldTart2;
       $(".icon-pencil.editOperation.insertDecBeforeAct").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecBeforeActDec").find("option:selected").val();
          $OldPostAct=$(this).parent().parent().find(".InsertDecBeforeActPostAct").find("option:selected").val();
          $OldCon1=$(this).parent().parent().find(".InsertDecBeforeActCon1").find("option:selected").val();
          $OldTart1=$(this).parent().parent().find(".InsertDecBeforeActTar1").find("option:selected").val();
          $OldCon2=$(this).parent().parent().find(".InsertDecBeforeActCon2").find("option:selected").val();
          $OldTart2=$(this).parent().parent().find(".InsertDecBeforeActTar2").find("option:selected").val();
          $OldUseCase=$(this).parent().parent().find(".InterBeforeActUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
  
      var $EditCon1,$EditCon2,$EditTart1,$EditTart2; 
      $(".icon-ok.editOperation.insertDecBeforeAct").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertDecBeforeAct").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
          
          $EditTarDec=$(this).parent().find(".InsertDecBeforeActDec").find("option:selected").val();
          $EditPostAct=$(this).parent().parent().find(".InsertDecBeforeActPostAct").find("option:selected").val();
          $EditCon1=$(this).parent().parent().find(".InsertDecBeforeActCon1").find("option:selected").val();
          $EditTart1=$(this).parent().parent().find(".InsertDecBeforeActTar1").find("option:selected").val();
          $EditCon2=$(this).parent().parent().find(".InsertDecBeforeActCon2").find("option:selected").val();
          $EditTart2=$(this).parent().parent().find(".InsertDecBeforeActTar2").find("option:selected").val();
          $EditUseCase=$(this).parent().parent().find(".InterBeforeActUseCase").find("option:selected").val();

         var $nums=0;

        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++; console.log($nums+":"+$(this).html());
          if($nums==1&&$(this).html()==$OldTarDec.split(".")[1]){
            $(this).html($EditTarDec.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldPostAct.split(".")[1]){
            $(this).html($EditPostAct.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldCon1.split(".")[1]){
            $(this).html($EditCon1.split(".")[1]);
          }
          if($nums==4&&$(this).html()==$OldTart1.split(".")[1]){
            $(this).html($EditTart1.split(".")[1]);
          }
          if($nums==5&&$(this).html()==$OldCon2.split(".")[1]){
            $(this).html($EditCon2.split(".")[1]);
          }
          if($nums==6&&$(this).html()==$OldTart2.split(".")[1]){
            $(this).html($EditTart2.split(".")[1]);
          }
          if($nums==7&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($EditUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$EditTarDec.split(".")[1]+" before "+$EditPostAct.split(".")[1]+" with ( "+$EditCon1.split(".")[1]+" , "+$EditTart1.split(".")[1]+" ),( "+$EditCon2.split(".")[1]+" , "+$EditTart2.split(".")[1]+" ) in "+$EditUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();
         
          $.ajax({
            type: "POST",
            url: "/EditInsertDecBeforeAct",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertDecBeforeActCon_guardID").val(),
              EditTarDec:$EditTarDec,
              EditPostAct:$EditPostAct,
              EditCon1:$EditCon1,
              EditTart1:$EditTart1,
              EditCon2:$EditCon2,
              EditTart2:$EditTart2,
              EditUseCase:$EditUseCase,
              OldTarDec:$OldTarDec,
              OldPostAct:$OldPostAct,
              OldCon1:$OldCon1,
              OldTart1:$OldTart1,
              OldCon2:$OldCon2,
              OldTart2:$OldTart2,
              OldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$("#hidden_insertDecBeforeActCon_guardID").val(),
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss!!!");
              alert(typeof(a));
            }
          });  

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })
      var $OldInsertTarDec,$OldPostAct;
      $(".icon-pencil.editOperation.insertDecBeforeActWith").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecBeforeActWithTar").find("option:selected").val();
          $OldPostAct=$(this).parent().parent().find(".InsertDecBeforeActWithPostAct").find("option:selected").val();
          $OldMainCon=$(this).parent().parent().find(".InsertDecBeforeActWithMainCon").find("option:selected").val();
          $OldSBCon=$(this).parent().parent().find(".InsertDecBeforeActWithSupCon").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecBeforeActWithInserAct").find("option:selected").val();
          $OldInsertTarDec=$(this).parent().parent().find(".InsertDecBeforeActWithDec").find("option:selected").val(); 
          $OldUseCase=$(this).parent().parent().find(".InsertDecBeforeActWithUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
      var $EditInsertTarDec,$EditPostAct;
      $(".icon-ok.editOperation.insertDecBeforeActWith").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertDecBeforeActWit").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
          
          var $EditTarDec=$(this).parent().find(".InsertDecBeforeActWithTar").find("option:selected").val();
          var $EditPostAct=$(this).parent().parent().find(".InsertDecBeforeActWithPostAct").find("option:selected").val();
          var $EditMainCon=$(this).parent().parent().find(".InsertDecBeforeActWithMainCon").find("option:selected").val();
          var $EditSBCon=$(this).parent().parent().find(".InsertDecBeforeActWithSupCon").find("option:selected").val();
          var $EditInsertAct=$(this).parent().parent().find(".InsertDecBeforeActWithInserAct").find("option:selected").val();
          var $EditInsertTarDec=$(this).parent().parent().find(".InsertDecBeforeActWithDec").find("option:selected").val(); 
          var $EditUseCase=$(this).parent().parent().find(".InsertDecBeforeActWithUseCase").find("option:selected").val();
         var $nums=0;

        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++; console.log($nums+":"+$(this).html());
          if($nums==1&&$(this).html()==$OldTarDec.split(".")[1]){
            $(this).html($EditTarDec.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldPostAct.split(".")[1]){
            $(this).html($EditPostAct.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldMainCon.split(".")[1]){
            $(this).html($EditMainCon.split(".")[1]);
          }
          if($nums==4&&$(this).html()==$OldSBCon.split(".")[1]){
            $(this).html($EditSBCon.split(".")[1]);
          }
          if($nums==5&&$(this).html()==$OldInsertAct.split(".")[1]){
            $(this).html($EditInsertAct.split(".")[1]);
          }
          if($nums==6&&$(this).html()==$OldInsertTarDec.split(".")[1]){
            $(this).html($EditInsertTarDec.split(".")[1]);
          }
          if($nums==7&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($EditUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$EditTarDec.split(".")[1]+" before "+$EditPostAct.split(".")[1]+" with ( "+$EditMainCon.split(".")[1]+" ),( "+$EditSBCon.split(".")[1]+" , "+$EditInsertAct.split(".")[1]+" , "+$EditInsertTarDec.split(".")[1]+" ) in "+$EditUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);
        console.log("tempname:"+$tempname);
          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();

          $.ajax({
            type: "POST",
            url: "/EditInsertDecBeforeActWith",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertDecBeforeActWit_guardID").val(),
              EditTarDec:$EditTarDec,
              EditPostAct:$EditPostAct,
              EditMainCon:$EditMainCon,
              EditSBCon:$EditSBCon,
              EditInsertAct:$EditInsertAct,
              EditInsertTarDec:$EditInsertTarDec,
              EditUseCase:$EditUseCase,
              OldTarDec:$OldTarDec,
              OldPostAct:$OldPostAct,
              OldMainCon:$OldMainCon,
              OldSBCon:$OldSBCon,
              OldInsertAct:$OldInsertAct,
              OldInsertTarDec:$OldInsertTarDec,
              OldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$("#hidden_insertDecBeforeActWit_guardID").val(),
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss");
              alert(typeof(a));
            }
          }); 

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })

      var $OldInsertDec,$OldInsertCon;
      $(".icon-pencil.editOperation.insertDecBeforeActCon").click(function(){
          $OldTarDec=$(this).parent().find(".InsertDecBeforeActConTar").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecBeforeActConPostAct").find("option:selected").val();
          $OldInsertCon=$(this).parent().parent().find(".InsertDecBeforeActConInserCon").find("option:selected").val();
          $OldMainCon=$(this).parent().parent().find(".InsertDecBeforeActConMainCon").find("option:selected").val();
          $OldSBCon=$(this).parent().parent().find(".InsertDecBeforeActConSupCon").find("option:selected").val();
          $OldInsertAct=$(this).parent().parent().find(".InsertDecBeforeActConInserAct").find("option:selected").val();
          $OldInsertTarDec=$(this).parent().parent().find(".InsertDecBeforeActConTarDec").find("option:selected").val(); 
          $OldUseCase=$(this).parent().parent().find(".InsertDecBeforeActConUseCase").find("option:selected").val();
        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",false);
          
        })
        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();
      })
  
      var $EditInsertDec,$EditInsertCon;
      $(".icon-ok.editOperation.insertDecBeforeActCon").click(function(){
        var $hidden_fields=$(this).parent().parent().parent().find("#hidden_insertDecBeforeActCon").val();

        jQuery.each($(this).parent().parent().parent(),function(){
          $(this).find('select').attr("disabled",true);
        })
          $EditTarDec=$(this).parent().find(".InsertDecBeforeActConTar").find("option:selected").val();
          $EditInsertAct=$(this).parent().parent().find(".InsertDecBeforeActConPostAct").find("option:selected").val();
          $EditInsertCon=$(this).parent().parent().find(".InsertDecBeforeActConInserCon").find("option:selected").val();
          $EditMainCon=$(this).parent().parent().find(".InsertDecBeforeActConMainCon").find("option:selected").val();
          $EditSBCon=$(this).parent().parent().find(".InsertDecBeforeActConSupCon").find("option:selected").val();
          $EditInsertAct=$(this).parent().parent().find(".InsertDecBeforeActConInserAct").find("option:selected").val();
          $EditInsertTarDec=$(this).parent().parent().find(".InsertDecBeforeActConTarDec").find("option:selected").val(); 
          $EditUseCase=$(this).parent().parent().find(".InsertDecBeforeActConUseCase").find("option:selected").val();

         var $nums=0;

        $(this).parent().parent().parent().parent().parent().find("b").each(function(i){
          $nums++; console.log($nums+":"+$(this).html());
          if($nums==1&&$(this).html()==$OldTarDec.split(".")[1]){
            $(this).html($EditTarDec.split(".")[1]);
          }
          if($nums==2&&$(this).html()==$OldInsertAct.split(".")[1]){
            $(this).html($EditInsertAct.split(".")[1]);
          }
          if($nums==3&&$(this).html()==$OldInsertCon.split(".")[1]){
            $(this).html($EditInsertCon.split(".")[1]);
          }
          if($nums==4&&$(this).html()==$OldMainCon.split(".")[1]){
            $(this).html($EditMainCon.split(".")[1]);
          }
          if($nums==5&&$(this).html()==$OldSBCon.split(".")[1]){
            $(this).html($EditSBCon.split(".")[1]);
          }
          if($nums==6&&$(this).html()==$OldInsertAct.split(".")[1]){
            $(this).html($EditInsertAct.split(".")[1]);
          }
          if($nums==7&&$(this).html()==$OldInsertTarDec.split(".")[1]){
            $(this).html($EditInsertTarDec.split(".")[1]);
          }
          if($nums==8&&$(this).html()==$OldUseCase.split(".")[1]){
            $(this).html($EditUseCase.split(".")[1]);
          }
           
        })
        var $tempname="Insert "+$EditTarDec.split(".")[1]+" before ( "+$EditInsertAct.split(".")[1]+" , "+$EditInsertCon.split(".")[1]+" )"+" with ( "+$EditMainCon.split(".")[1]+" ),( "+$EditSBCon.split(".")[1]+" , "+$EditInsertAct.split(".")[1]+" , "+$EditInsertTarDec.split(".")[1]+" ) in "+$EditUseCase.split(".")[1];
        $(this).parent().parent().parent().parent().parent().parent().attr("id",$tempname);

          $operation_position="";
          var $mark=false;
       $(".section_accordion").each(function(){
          if($operation_position!="")
            $operation_position=$operation_position+"$";
          
          $operation_position=$operation_position+$(this).attr("id");
       })
         $(this).css("display","none");
         $(this).siblings().show();
         
          $.ajax({
            type: "POST",
            url: "/EditInsertDecBeforeActCon",
            async:false,
            data: {
              user:"<%=tracerules[0].user%>",
              id:$("#hidden_insertDecBeforeActCon_guardID").val(),
              EditTarDec:$EditTarDec,
              EditInsertAct:$EditInsertAct,
              EditInsertCon:$EditInsertCon,
              EditMainCon:$EditMainCon,
              EditSBCon:$EditSBCon,
              EditInsertAct:$EditInsertAct,
              EditInsertTarDec:$EditInsertTarDec,
              EditUseCase:$EditUseCase,
              OldTarDec:$OldTarDec,
              OldInsertAct:$OldInsertAct,
              OldInsertCon:$OldInsertCon,
              OldMainCon:$OldMainCon,
              OldSBCon:$OldSBCon,
              OldInsertAct:$OldInsertAct,
              OldInsertTarDec:$OldInsertTarDec,
              OldUseCase:$OldUseCase,
              positions:$operation_position,
              current_guard_id:$current_guard_id,
              hidden_fields:$("#hidden_insertDecBeforeActCon_guardID").val(),
              projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
              elementdepencyss=Object.elementdepencys;
              console.log(elementdepencyss);

            },
            error:function(a){

              alert("errssssssss!!!");
              alert(typeof(a));
            }
          });  

        //$(this).parent().parent().parent().('input').attr("readonly",false);
         $(this).css("display","none");
         $(this).siblings().show();

      })

      var $edit_guard_id;
      var $current_guard_id;
      $(".icon-pencil.GuardListStyle").click(function(event){
        $edit_guard_id=$(this).parent().attr('name');
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
        $( "#editSelfName" ).dialog( "open" );
        event.stopPropagation(); 
      })

      $(".myInsideA").click(function(){
        if($(this).attr('name')!=null){
          var $subroute=$("#hidden_project_id").val()+"_"+$(this).attr('name');
          console.log("subroute:"+$subroute);
          window.location.href="/T/"+$subroute;

        }
      })

      $( "#confirmDelete" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          buttons: {

            "Confirm": function() {
              $operation_position="";
              $(".section_accordion").each(function(){
                        if($operation_position!="")
                            $operation_position=$operation_position+"$";

                            $operation_position=$operation_position+$(this).attr("id");

                        })
             // window.location.href="/DeleteTraceRule/"+"<%=tracerules[0].user%>分"+$deleteID+"分"+$operation_position+"分"+$current_guard_id;
               $.ajax({
                type: "POST",
                url: "/DeleteTraceRule",
                data: {
                  showID:$(this).attr('name'),
                  deleteID:$deleteID,
                  operation_position:$operation_position,
                  current_guard_id:$current_guard_id,
                  projectID:$("#hidden_project_id").val()
                },
                dataType:'json',
                success:function(Object){
                  console.log("success!!!!");
                    window.location.href="/T/"+$("#hidden_project_id").val();
                },
                error:function(){
                  console.log("err");
                }
              });

            
             $( this ).dialog( "close" );   
        },
      },
      close: function() {
        
      }
    });

      var $deleteID;
      $(".icon-remove").click(function(){
        
        $deleteID=$(this).parent().attr('name');
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
        $( "#confirmDelete" ).dialog( "open" );
        event.stopPropagation();
      })
    

      $(".myInsideA").each(function(index){
          $(this).click(function(){
            $(".myInsideA.focusBgColor").removeClass("focusBgColor");
            $(this).addClass("focusBgColor");
          })
        })

      $(".icon-pencil").mouseover(function(){
        $(this).addClass("getFocus");
      })

      $(".icon-pencil").mouseout(function(){
        $(this).removeClass("getFocus");
      })

       $(".icon-remove").mouseover(function(){
        $(this).addClass("getFocus");
      })

      $(".icon-remove").mouseout(function(){
        $(this).removeClass("getFocus");
      })

      $(".icon-plus").mouseover(function(){
        $(this).addClass("getFocus");
      })

      $(".icon-plus").mouseout(function(){
        $(this).removeClass("getFocus");
      })

      $(".icon-plus").click(function(){
        $current_accordion=$(this).parent().parent().parent().attr("id");

        sel_elm.each(function(){
          this.selectedIndex=-1;
        })
        rad_elm.get(0).checked=false;

        $( "#addOperation" ).dialog( "open" );
        event.stopPropagation();

      })

      $(".icon-ok").mouseover(function(){
        $(this).addClass("getFocus");
      })

      $(".icon-ok").mouseout(function(){
        $(this).removeClass("getFocus");
      })

      $(".icon-minus").mouseover(function(){
        $(this).addClass("getFocus");
      })

      $(".icon-minus").mouseout(function(){
        $(this).removeClass("getFocus");
      })

      $(".icon-minus.deleteActivity").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteActivity/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position;
         $.ajax({
            type: "POST",
            url: "/DeleteActivity",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             if(Object.errs!=undefined){
                alert(Object.errs);
             }
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(err){
              
              console.log(err.responseText);

            }
          });

      })

      $(".icon-minus.deleteDecision").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteDecision/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position;
         $.ajax({
            type: "POST",
            url: "/DeleteDecision",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             if(Object.errs!=undefined){
                alert(Object.errs);
             }
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });


      })

     $(".icon-minus.deleteCondition").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteCondition/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position;
         $.ajax({
            type: "POST",
            url: "/DeleteCondition",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             if(Object.errs!=undefined){
                alert(Object.errs);
             }
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })

      $(".icon-minus.deleteUseCase").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteUseCase/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position;

         $.ajax({
            type: "POST",
            url: "/DeleteUseCase",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             if(Object.errs!=undefined){
                alert(Object.errs);
             }
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });


      })
//I2
      $(".icon-minus.insertactafterpre").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
          var $hidden_fields=$(this).parent().parent().find("#hidden_insertactafterpre").val();
         
         $(this).parent().remove();
         $operation_position="";
        
         
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertActAfterPre/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;

          $.ajax({
            type: "POST",
            url: "/DeleteInsertActAfterPre",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });


      })
//I3
      $(".icon-minus.insertActBeforePost").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
          var $hidden_fields=$(this).parent().parent().find("#hidden_insertActBeforePost").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertActBeforePost/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
           $.ajax({
            type: "POST",
            url: "/DeleteInsertActBeforePost",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })

      
//I4
      $(".icon-minus.deleteInsertActAfterDecCon").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertActAfterDecCon").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertActAfterDecCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertActAfterDecCon",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })
//I5      
      $(".icon-minus.deleteInsertActBeforeActCon").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertActBeforeActCon").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertActBeforeActCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertActBeforeActCon",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })
//I6
      $(".icon-minus.deleteInsertDecAfterAct").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertDecAfterAct").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertDecAfterAct/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertDecAfterAct",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })

//I7
      $(".icon-minus.deleteInsertDecAfterDecCon").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertDecAfterDecCon").val();
         $(this).parent().remove();
         $operation_position="";
        alert("hi");
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertDecAfterDecCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
          $.ajax({
            type: "POST",
            url: "/DeleteInsertDecAfterDecCon",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })
//I8
    $(".icon-minus.deleteInsertDecBeforeAct").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertDecBeforeAct").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertDecBeforeAct/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertDecBeforeAct",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })
//I9
      $(".icon-minus.deleteInsertDecBeforeActWith").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertDecBeforeActWit").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertDecBeforeActWith/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertDecBeforeActWith",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })
//I10
    $(".icon-minus.deleteInsertDecBeforeActCon").click(function(){
         $current_accordion=$(this).parent().parent().parent().attr("id");
         var $hidden_fields=$(this).parent().parent().find("#hidden_insertDecBeforeActCon").val();
         $(this).parent().remove();
         $operation_position="";
        
         $(".section_accordion").each(function(){

         if($operation_position!="" && $(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+"$";
          if($(this).attr("id")!=$current_accordion)
            $operation_position=$operation_position+$(this).attr("id");

       })
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         //window.location.href="/DeleteInsertDecBeforeActCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$current_accordion+"分"+$operation_position+"分"+$hidden_fields;
         $.ajax({
            type: "POST",
            url: "/DeleteInsertDecBeforeActCon",
            data: {
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             hidden_fields:$hidden_fields,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

      })

      $( "#radio" ).buttonset();
    // Add Accordion stuff
    $(".accordion").accordion({
      autoHeight: false,
      active: false,
      collapsible: true
    }); // end $(".accordion").accordion

    // Add sortables
    $('.sortable').sortable({
      start: function(e, ui) {
        container = $(e.target);

        var parent_id = container.parent().parent().attr('id');
        expanded_ones = new Array();
        var count = 0;
        var summary = '';
        var child = '';
        var active = '';

        // now close all other sections
        $.each($('#' + parent_id + ' .accordion'), function() {
          // get the child element since that has the div id I need
          child = $(this).children('div');

          // get the active information to see if it is open or closed
          active = $(this).accordion('option', 'active');

          // check to see if this one is expanded
          if(parseInt(active) == active) {
            // store this id so we can open it later
            expanded_ones[count] = $(child).attr('id');
            count++;

            // and close the accordion
            $(this).accordion({ active: false });
          } // end if(parseInt(active) == active)
        }); // end $.each($('#' + parent_id + ' .accordion'), function()
      }, // end start: function(e, ui)
      stop: function(e, ui) {
        container = $(e.target);

        var parent_elem = '';

        // expand the ones that were originally expanded
        for(var i = 0; i < expanded_ones.length; i++) {
          parent_elem = $('#' + expanded_ones[i]).parent();
          $(parent_elem).accordion('option', 'active', 0);
        } // end for(var i = 0; i < expanded_ones; i++)
      } // end stop: function(e, ui)
    }); // end $('.sortable').sortable

      


        $( "#dialog-form" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          buttons: {

            "Confirm": function() {
            $(".nav-list-1:last").remove();

              $selfName=$("#selfDescription").val();

              $str="";
              $('input[name="featurename"]:checked').each(function(){
                
              if($str != "")
              {
                $str=$str+"&nbsp;∨&nbsp;";
              }
              var $val=$('input:radio[name=\"'+$(this).val()+'\"]:checked').val();
              if($val != "no")
                $str=$str+"⌉";
    
              $str=$str+$(this).val();
            })
            
            $("#guardlist").append("<li class=\"nav-list-1\"><a href=\"javascript:;\" class=\"myInside\">"+$selfName+"<i class=\"icon-remove GuardListStyle\" ></i></a></li>").find('.myInside').mouseover(function(){$(this).children().show();}).mouseout(function(){$(this).children().hide();}).each(function(index){$(this).click(function(){$(".myInside.focusBgColor").removeClass("focusBgColor");$(this).addClass("focusBgColor");})}).find('.icon-remove').mouseover(function(){$(this).addClass("getFocus");}).mouseout(function(){$(this).removeClass("getFocus");}).click(function(){$(this).parent().remove();});

            
            $("#guardlist").append("<li class=\"nav-list-1\"><a href=\"javascript:;\" class=\"myInsidePlus\" style=\"text-align:center;margin-bottom:0px;vertical-align:middle;\"><i class=\"icon-plus-sign\"></i></a></li>").find('.icon-plus-sign').click(function(){$( "#dialog-form" ).dialog( "open" );});

            $( this ).dialog( "close" );
          
        },
      },
      close: function() {
        if($str!=null){
          $.ajax({
            type: "POST",
            url: "/post",
            data: {
              selfName:$selfName,
              featurename:$str, 
              types:1
           },
            dataType:'json',
           success: function(msg){
              alert( "Data Saved: " + msg );
            }
          });
        }
      }
    });

      $( "#editSelfName" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          buttons: {

            "Confirm": function() {
              $selfname=$("#selfname").val();
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
        if($selfname!="")
        {
          //window.location.href="/doT/"+$selfname+"分<%=tracerules[0].user%>"+"分<%=tracerules[0].name%>"+"分<%=tracerules[0]._id%>分"+$current_guard_id;
          $operation_position="";
              $(".section_accordion").each(function(){
                        if($operation_position!="")
                            $operation_position=$operation_position+"$";

                            $operation_position=$operation_position+$(this).attr("id");

                        })

          $.ajax({
            type: "POST",
            url: "/doT",
            data: {
             selfname:$selfname,
             operation_position:$operation_position,
             edit_guard_id:$edit_guard_id,
             current_guard_id:$current_guard_id
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            
            },
            error:function(){

            }
          });
        }
      }
    });
 
      $( "#addOperation" ).dialog({
          autoOpen: false,
          width: 600,
          modal: true,
          buttons: {

            "Confirm": function() {
               $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
                
                var $Type=$('input:radio[name=TDLType]:checked').val();
                if($Type!="F")
                  $TDLType=$('input:radio[name=TDLType]:checked').parent().find("option:selected").val();
                else
                  $TDLType="F";
                
              //  $TDLType=$(".TDLType").find("option:selected").val();
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
        //window.location.href="/doT/"+$selfname+"分<%=tracerules[0].user%>"+"分<%=tracerules[0].name%>"+"分<%=tracerules[0]._id%>分"+$current_guard_id;
        switch($TDLType){
          case "C1":
            $( "#CreateUseCase" ).dialog( "open" );
            break;
          case "C2":
            $( "#CreateActivity" ).dialog( "open" );
            break;
          case "C3":
            $("#CreateDecision").dialog("open");
            break;
          case "C4":
            $("#CreateCondition").dialog("open");
            break;
       /*   case "I1":
            $("#InsertBetween").dialog("open");
            break;
        */
          case "I2":
            $("#InsertActAfterPre").load("/InsertActAfterPreDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertActAfterPre").dialog("open");
            break;
          case "I3":
             $("#InsertActBeforePost").load("/InsertActBeforePostDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
             $("#InsertActBeforePost").dialog("open");
            break;
          case "I4":
            $("#InsertActAfterDecCon").load("/InsertActAfterDecConDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertActAfterDecCon").dialog("open");
            break;
          case "I5":
            $("#InsertActBeforeActCon").load("/InsertActBeforeActConDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertActBeforeActCon").dialog("open");
            break;
          case "I6":
            $("#InsertDecAfterAct").load("/InsertDecAfterActDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertDecAfterAct").dialog("open");
            break;
          case "I7":
            $("#InsertDecAfterDecCon").load("/InsertDecAfterDecConDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertDecAfterDecCon").dialog("open");
            break;
          case "I8":
            $("#InsertDecBeforeAct").load("/InsertDecBeforeActDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertDecBeforeAct").dialog("open");
            break;
          case "I9":
            $("#InsertDecBeforeActWith").load("/InsertDecBeforeActWithDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertDecBeforeActWith").dialog("open");
            break;
          case "I10":
            $("#InsertDecBeforeActCon").load("/InsertDecBeforeActConDialog/"+$("#hidden_project_id").val()+"_"+$current_guard_id);
            $("#InsertDecBeforeActCon").dialog("open");
            break;
          default:
            break;
        }
       $TDLType=" ";
      }
    });

     $( "#CreateActivity" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              $activityname=$("#activityname").val();
        $activitydescription=$("#activitydescription").val();
        $activityexecutor=$('input:radio[name=ExecutorType]:checked').val();
    
        if($activityname.indexOf("_")>-1){
          alert("Activity name can't include '_'");
        }else{

       /*  
        if($("#activityvirtual").is(":checked")==true){
          $activityvirtual="true";
        }else{
          $activityvirtual="false";
        }
       */
        $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");
          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Create Activity "+$activityname;
          }
       })
       if($ifNone)
          $operation_position="Create Activity "+$activityname;
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");

              $( this ).dialog( "close" );
            }
          
        },
      },
      close: function() {
       if($("#activityname").val()!=""&&$("#activitydescription").val()!=""&&$activityname.indexOf("_")==-1){
        
        //window.location.href="/createActivity/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$activityname+"分"+$activitydescription+"分"+$activityexecutor+"分"+$current_accordion+"分"+$operation_position+"分"+$current_guard_id;
        $.ajax({
            type: "POST",
            url: "/createActivity",
            data: {
             activityname:$activityname,
             activitydescription:$activitydescription,
             activityexecutor:$activityexecutor,
             current_accordion:$current_accordion,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
            },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

       }
      }
    });
    
    $( "#CreateUseCase" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
        
        $usecasename=$("#usecasename").val();
        $usecasedescription=$("#usecasedescription").val();
        if($usecasename.indexOf("_")>-1||$usecasename.indexOf(" ")>-1){
          alert("Use case name can't include '_' or space");
        }else{
        $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
           $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");
          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Create Use Case "+$usecasename;
          }
       })
       if($ifNone){
          $operation_position="Create Use Case "+$usecasename;
       }
       
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
              $( this ).dialog( "close" );
            }
          
        },
      },
      close: function() {
        //window.location.href="/doT/"+$selfname+"分<%=tracerules[0].user%>"+"分<%=tracerules[0].name%>"+"分<%=tracerules[0]._id%>分"+$current_guard_id;
        if($("#usecasename").val()!=""&&$usecasename.indexOf("_")==-1&&$usecasename.indexOf(" ")==-1){

        //window.location.href="/createUseCase/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$usecasename+"分"+$usecasedescription+"分"+$operation_position+"分"+$current_guard_id;
          $.ajax({
            type: "POST",
            url: "/createUseCase",
            data: {
             usecasename:$usecasename,
             usecasedescription:$usecasedescription,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
        }
      }
    });
  
    $( "#CreateDecision" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
               $decisionname=$("#decisionname").val();
               $decisiondescription=$("#decisiondescription").val();
               $decisionexecutor=$('input:radio[name=DecisionExecutorType]:checked').val();
        if($decisionname.indexOf("_")>-1){
          alert("Decision name can't include '_'");
        }else{
        
        $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");
          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Create Decision "+$decisionname;
          }
       })
       if($ifNone)
          $operation_position="Create Decision "+$decisionname;
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
              $( this ).dialog( "close" );
          }
        },
      },
      close: function() {
        //window.location.href="/doT/"+$selfname+"分<%=tracerules[0].user%>"+"分<%=tracerules[0].name%>"+"分<%=tracerules[0]._id%>分"+$current_guard_id;
        if($("#decisionname").val()!=""&&$("#decisiondescription").val()!=""&&$decisionname.indexOf("_")==-1){
        //window.location.href="/createDecision/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$decisionname+"分"+$decisiondescription+"分"+$decisionexecutor+"分"+$operation_position+"分"+$current_guard_id;
          $.ajax({
            type: "POST",
            url: "/createDecision",
            data: {
             decisionname:$decisionname,
             decisiondescription:$decisiondescription,
             decisionexecutor:$decisionexecutor,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
        }
      }
    });

    $( "#CreateCondition" ).dialog({
          autoOpen: false,
          width: 450,
          modal: true,
          buttons: {

            "Confirm": function() {
        $conditionname=$("#conditionname").val();
        $conditiondescription=$("#conditiondescription").val();
      if($conditionname.indexOf("_")>-1){
        alert("Condition name can't include '_'");
      }else{
        $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");
          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Create Condition "+$conditionname;
          }
       })
       if($ifNone)
        $operation_position="Create Condition "+$conditionname;
        $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
              $( this ).dialog( "close" );
          }
        },
      },
      close: function() {
        //window.location.href="/doT/"+$selfname+"分<%=tracerules[0].user%>"+"分<%=tracerules[0].name%>"+"分<%=tracerules[0]._id%>分"+$current_guard_id;
         if($("#conditionname").val()!=""&&$("#conditiondescription").val()!=""&&$conditionname.indexOf("_")==-1){
         //window.location.href="/createCondition/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$conditionname+"分"+$conditiondescription+"分"+$operation_position+"分"+$current_guard_id;
          $.ajax({
            type: "POST",
            url: "/createCondition",
            data: {
             conditionname:$conditionname,
             conditiondescription:$conditiondescription,
             operation_position:$operation_position,
             current_guard_id:$current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
       }
      }
    });
    
     $( "#InsertBetween" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
        
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          //var $TartAct=$('select[class^="InterBetTar"]').val();
           var $marks=true;

          var $TartAct=$("#InterBetTar").find("option:selected").val();
          var $PreAct=$("#InterBetPre").find("option:selected").val();
          var $PostAct=$("#InterBetPost").find("option:selected").val();
          var $UseCase=$("#InterBetUseCase").find("option:selected").val();
          if($TartAct=="-1"||$PreAct=="-1"||$PostAct=="-1"||$UseCase=="-1")
            $marks=false;

          var TargetActivity=$("#InterBetTar").find("option:selected").val().split('_');
          var PreActivity=$("#InterBetPre").find("option:selected").val().split('_');
          var PostActivity=$("#InterBetPost").find("option:selected").val().split('_');
          var Usecase=$("#InterBetUseCase").find("option:selected").val().split('_');
        
            $operation_position="";
          var $mark=false;
          var $ifNone=true;
          $(".section_accordion").each(function(){
            $ifNone=false;
            if($(this).attr("id")==$current_accordion)
              $mark=true;

            if($operation_position!="")
              $operation_position=$operation_position+"$";
              $operation_position=$operation_position+$(this).attr("id");

            if($mark){
              $mark=false;
              if($operation_position!="")
                $operation_position=$operation_position+"$";

              $operation_position=$operation_position+"Insert "+TargetActivity[1]+" between "+PreActivity[1]+" and "+PostActivity[1]+" in "+Usecase[1];
            }
        })
          if($ifNone)
            $operation_position="Insert "+TargetActivity[1]+" between "+PreActivity[1]+" and "+PostActivity[1]+" in "+Usecase[1];
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
          if($marks==true){
           window.location.href="/InsertBetween/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartAct+"分"+$PreAct+"分"+$PostAct+"分"+$UseCase+"分"+$operation_position+"分"+$current_guard_id;
         }
         
      
        }
      });

      $( "#InsertActAfterPre" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          //var $TartAct=$('select[class^="InterBetTar"]').val();
          var $marks=true;
          var $TartAct=$("#InterPreTar").find("option:selected").val();
          var $PreAct=$("#InterPrePre").find("option:selected").val();
          var $UseCase=$("#InterPreUseCase").find("option:selected").val();
          
          if($TartAct=="-1"||$PreAct=="-1"||$UseCase=="-1")
            $marks=false;

        var TargetActivity=$("#InterPreTar").find("option:selected").val().split('.');
        var PreActivity=$("#InterPrePre").find("option:selected").val().split('.');
        var Usecase=$("#InterPreUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+TargetActivity[1]+" after "+PreActivity[1]+" in "+Usecase[1];
          }
       })
        if($ifNone)
          $operation_position="Insert "+TargetActivity[1]+" after "+PreActivity[1]+" in "+Usecase[1];
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
          if($marks){
           //window.location.href="/InsertActAfterPre/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartAct+"分"+$PreAct+"分"+$UseCase+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertActAfterPre",
            data: {
             TarAct:$TartAct,
             PreAct:$PreAct,
             UseCase:$UseCase,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

         }
      
      }
    });

    $( "#InsertActBeforePost" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
             
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          //var $TartAct=$('select[class^="InterBetTar"]').val();
          var $marks=true;
          var $TartAct=$("#InterPostTar").find("option:selected").val();
          var $PostAct=$("#InterPostPost").find("option:selected").val();
          var $UseCase=$("#InterPostUseCase").find("option:selected").val();
          
          if($TartAct=="-1"||$PostAct=="-1"||$UseCase=="-1")
            $marks=false;

        var TargetActivity=$("#InterPostTar").find("option:selected").val().split('.');
        var PostActivity=$("#InterPostPost").find("option:selected").val().split('.');
        var Usecase=$("#InterPostUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+TargetActivity[1]+" before "+PostActivity[1]+" in "+Usecase[1];
          }
       })
       if($ifNone)
         $operation_position="Insert "+TargetActivity[1]+" before "+PostActivity[1]+" in "+Usecase[1];
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
          if($marks)
           //window.location.href="/InsertActBeforePost/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartAct+"分"+$PostAct+"分"+$UseCase+"分"+$operation_position+"分"+$current_guard_id;
          $.ajax({
            type: "POST",
            url: "/InsertActBeforePost",
            data: {
             TarAct:$TartAct,
             PostAct:$PostAct,
             UseCase:$UseCase,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
      
      }
    });

  $( "#InsertActAfterDecCon" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          //var $TartAct=$('select[class^="InterBetTar"]').val();
          var $marks=true;
          var $TartAct=$("#InterAfterDecConTar").find("option:selected").val();
          var $Dec=$("#InterAfterDecConDec").find("option:selected").val();
          var $Con=$("#InterAfterDecConCon").find("option:selected").val();
          var $UC=$("#InterAfterDecConUseCase").find("option:selected").val();
          
          if($TartAct=="-1"||$Dec=="-1"||$Con=="-1"||$UC=="-1")
            $marks=false;
        
        var TargetActivity=$("#InterAfterDecConTar").find("option:selected").val().split('.');
        var Decision=$("#InterAfterDecConDec").find("option:selected").val().split('.');
        var Conditon=$("#InterAfterDecConCon").find("option:selected").val().split('.');
        var UseCase=$("#InterAfterDecConUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+TargetActivity[1]+" after "+Decision[1]+" , "+Conditon[1]+" in "+UseCase[1];
          }
       })
        if($ifNone)
          $operation_position="Insert "+TargetActivity[1]+" after "+Decision[1]+" , "+Conditon[1]+" in "+UseCase[1];

          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         if($marks){
           //window.location.href="/InsertActAfterDecCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartAct+"分"+$Dec+"分"+$Con+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertActAfterDecCon",
            data: {
             TarAct:$TartAct,
             Dec:$Dec,
             Con:$Con,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

         }
      
      }
    });

    $( "#InsertActBeforeActCon" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          //var $TartAct=$('select[class^="InterBetTar"]').val();
          var $marks=true;
          var $TartAct=$("#InterBeforeActConTar").find("option:selected").val();
          var $PostAct=$("#InterBeforeActConAct").find("option:selected").val();
          var $Con=$("#InterBeforeActConCon").find("option:selected").val();
          var $UC=$("#InterBeforeActConUseCase").find("option:selected").val();
          
          if($TartAct=="-1"||$PostAct=="-1"||$Con=="-1"||$UC=="-1")
            $marks=false;

        var TargetActivity=$("#InterBeforeActConTar").find("option:selected").val().split('.');
        var PostActivity=$("#InterBeforeActConAct").find("option:selected").val().split('.');
        var Conditon=$("#InterBeforeActConCon").find("option:selected").val().split('.');
        var UseCase=$("#InterBeforeActConUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
        $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+TargetActivity[1]+" before "+PostActivity[1]+" , "+Conditon[1]+" in "+UseCase[1];
          }
       })
       if($ifNone)
        $operation_position="Insert "+TargetActivity[1]+" before "+PostActivity[1]+" , "+Conditon[1]+" in "+UseCase[1];
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         if($marks){
           //window.location.href="/InsertActBeforeActCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartAct+"分"+$PostAct+"分"+$Con+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertActBeforeActCon",
            data: {
             TarAct:$TartAct,
             PostAct:$PostAct,
             Con:$Con,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
         }
      
      }
    });

    $( "#InsertDecAfterAct" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          var $marks=true;
          var $TartDec=$("#InsertDecAfterActTar").find("option:selected").val();
          var $PreAct=$("#InsertDecAfterActPre").find("option:selected").val();
          var $MainBranchCon=$("#InsertDecAfterActMainCon").find("option:selected").val();
          var $SupBranchCon=$("#InsertDecAfterActSBCon").find("option:selected").val();
          var $InserAct=$("#InsertDecAfterActInserAct").find("option:selected").val();
          if($InserAct=="none")
            $InserAct="none_none";
          var $TargetAct=$("#InsertDecAfterActTarAct").find("option:selected").val();
          var $UC=$("#InsertDecAfterActUseCase").find("option:selected").val();
          
          if($TartDec=="-1"||$PreAct=="-1"||$MainBranchCon=="-1"||$SupBranchCon=="-1"||$InserAct=="-1"||$TargetAct=="-1"||$UC=="-1")
            $marks=false;

          var $TargetDecision=$("#InsertDecAfterActTar").find("option:selected").val().split('.');
          var $PreActivity=$("#InsertDecAfterActPre").find("option:selected").val().split('.');
          var $MainBranchConditon=$("#InsertDecAfterActMainCon").find("option:selected").val().split('.');
          var $SupBranchCondition=$("#InsertDecAfterActSBCon").find("option:selected").val().split('.');
          var $markInserAct=false;
          console.log("$InserAct:"+$InserAct);
          if($InserAct!="0"){
            $markInserAct=true;
            var $InserActivity=$("#InsertDecAfterActInserAct").find("option:selected").val().split('.');
          }
          else
          {
            var $InserActivity=[];
          }
          var $TargetActivity=$("#InsertDecAfterActTarAct").find("option:selected").val().split('.');
          var $UseCase=$("#InsertDecAfterActUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+$TargetDecision[1]+" after "          +$PreActivity[1]+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , ";
            if($markInserAct)
                $operation_position=$operation_position+$InserActivity[1]+" , ";
            $operation_position=$operation_position+$TargetActivity[1]+" ) in "+$UseCase[1];
          }
       })
          if($ifNone)
          {
            $operation_position="Insert "+$TargetDecision[1]+" after "          +$PreActivity[1]+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , ";
              if($markInserAct)
                $operation_position=$operation_position+$InserActivity[1]+" , ";
            $operation_position=$operation_position+$TargetActivity[1]+" ) in "+$UseCase[1];
          }
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         if($marks){
          // window.location.href="/InsertDecAfterAct/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartDec+"分"+$PreAct+"分"+$MainBranchCon+"分"+$SupBranchCon+"分"+$InserAct+"分"+$TargetAct+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
          $.ajax({
            type: "POST",
            url: "/InsertDecAfterAct",
            data: {
             TartDec:$TartDec,
             PreAct:$PreAct,
             MainBranchCon:$MainBranchCon,
             SupBranchCon:$SupBranchCon,
             InserAct:$InserAct,
             TargetAct:$TargetAct,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
         }
      
      }
    });

    $( "#InsertDecAfterDecCon" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          var $marks=true;
          var $TartDec=$("#InsertDecAfterDecConTar").find("option:selected").val();
          var $InsertDec=$("#InsertDecAfterDecConInserDec").find("option:selected").val();
          var $InsertCon=$("#InsertDecAfterDecConInserCon").find("option:selected").val();
          var $MainBranchCon=$("#InsertDecAfterDecConMainCon").find("option:selected").val();
          var $SupBranchCon=$("#InsertDecAfterDecConSBCon").find("option:selected").val();
          var $InserAct=$("#InsertDecAfterDecConInserAct").find("option:selected").val();
          var $TargetDec=$("#InsertDecAfterDecConTarDec").find("option:selected").val();
          var $UC=$("#InsertDecAfterDecConUseCase").find("option:selected").val();
          
          if($TartDec=="-1"||$InsertDec=="-1"||$InsertCon=="-1"||$MainBranchCon=="-1"||$SupBranchCon=="-1"||$InserAct=="-1"||$TargetDec=="-1"||$UC=="-1")
            $marks=false;

          var $TargetDecision=$("#InsertDecAfterDecConTar").find("option:selected").val().split('.');
          var $InsertDecision=$("#InsertDecAfterDecConInserDec").find("option:selected").val().split('.');
          var $InsertCondition=$("#InsertDecAfterDecConInserCon").find("option:selected").val().split('.');
          var $MainBranchConditon=$("#InsertDecAfterDecConMainCon").find("option:selected").val().split('.');
          var $SupBranchCondition=$("#InsertDecAfterDecConSBCon").find("option:selected").val().split('.');
          var $InserActivity=$("#InsertDecAfterDecConInserAct").find("option:selected").val().split('.');
          var $TargetDecisions=$("#InsertDecAfterDecConTarDec").find("option:selected").val().split('.');
          var $UseCase=$("#InsertDecAfterDecConUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
        $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+$TargetDecision[1]+" after ( "          +$InsertDecision[1]+" , "+$InsertCondition[1]+" )"+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
          }
       })
        if($ifNone)
        {
          $operation_position="Insert "+$TargetDecision[1]+" after ( "          +$InsertDecision[1]+" , "+$InsertCondition[1]+" )"+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
        }
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         

          if($marks){ 
           //window.location.href="/InsertDecAfterDecCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartDec+"分"+$InsertDec+"分"+$InsertCon+"分"+$MainBranchCon+"分"+$SupBranchCon+"分"+$InserAct+"分"+$TargetDec+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertDecAfterDecCon",
            data: {
             TartDec:$TartDec,
             InsertDec:$InsertDec,
             InsertCon:$InsertCon,
             MainBranchCon:$MainBranchCon,
             SupBranchCon:$SupBranchCon,
             InserAct:$InserAct,
             TargetDec:$TargetDec,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

           }
      
      }
    });

    $( "#InsertDecBeforeAct" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          var $marks=true;
          var $TartDec=$("#InsertDecBeforeActTar").find("option:selected").val();
          var $PostAct=$("#InsertDecBeforePostAct").find("option:selected").val();
          var $Con1=$("#InsertDecBeforeActCon1").find("option:selected").val();
          var $Tar1=$("#InsertDecBeforeActTar1").find("option:selected").val();
          var $Con2=$("#InsertDecBeforeActCon2").find("option:selected").val();
          var $Tar2=$("#InsertDecBeforeActTar2").find("option:selected").val();
          var $UC=$("#InsertDecBeforeActUseCase").find("option:selected").val();

          if($TartDec=="-1"||$PostAct=="-1"||$Con1=="-1"||$Tar1=="-1"||$Con2=="-1"||$Tar2=="-1"||$UC=="-1")
            $marks=false;

          var $TargetDecision=$("#InsertDecBeforeActTar").find("option:selected").val().split('.');
          var $PostActivity=$("#InsertDecBeforePostAct").find("option:selected").val().split('.');
          var $Condition1=$("#InsertDecBeforeActCon1").find("option:selected").val().split('.');
          var $Target1=$("#InsertDecBeforeActTar1").find("option:selected").val().split('.');
          var $Condition2=$("#InsertDecBeforeActCon2").find("option:selected").val().split('.');
          var $Target2=$("#InsertDecBeforeActTar2").find("option:selected").val().split('.');
          var $UseCase=$("#InsertDecBeforeActUseCase").find("option:selected").val().split('.');
        
        $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
        $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+$TargetDecision[1]+" before "          +$PostActivity[1]+" with ( "+$Condition1[1]+" , "+$Target1[1]+" ),( "+
            $Condition2[1]+" , "+$Target2[1]+" ) in "+$UseCase[1];
          }
       })
       if($ifNone)
       {
        $operation_position="Insert "+$TargetDecision[1]+" before "          +$PostActivity[1]+" with ( "+$Condition1[1]+" , "+$Target1[1]+" ),( "+
            $Condition2[1]+" , "+$Target2[1]+" ) in "+$UseCase[1];
       }
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         if($marks){
          // window.location.href="/InsertDecBeforeAct/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartDec+"分"+$PostAct+"分"+$Con1+"分"+$Tar1+"分"+$Con2+"分"+$Tar2+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertDecBeforeAct",
            data: {
             TartDec:$TartDec,
             PostAct:$PostAct,
             Con1:$Con1,
             Tar1:$Tar1,
             Con2:$Con2,
             Tar2:$Tar2,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });

         }
      
      }
    });

    $( "#InsertDecBeforeActWith" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          var $marks=true;
          var $TartDec=$("#InsertDecBeforeActWithTar").find("option:selected").val();
          var $PostAct=$("#InsertDecBeforeActWithPost").find("option:selected").val();
          var $MainBranchCon=$("#InsertDecBeforeActWithMainCon").find("option:selected").val();
          var $SupBranchCon=$("#InsertDecBeforeActWithSBCon").find("option:selected").val();
          var $InserAct=$("#InsertDecBeforeActWithInserAct").find("option:selected").val();
          var $TargetDec=$("#InsertDecBeforeActWithTarDec").find("option:selected").val();
          var $UC=$("#InsertDecBeforeActWithUseCase").find("option:selected").val();
          if($TartDec=="-1"||$PostAct=="-1"||$MainBranchCon=="-1"||$SupBranchCon=="-1"||$InserAct=="-1"||$TartDec=="-1"||$UC=="-1")
            $marks=false;

          var $TargetDecision=$("#InsertDecBeforeActWithTar").find("option:selected").val().split('.');
          var $PostActivity=$("#InsertDecBeforeActWithPost").find("option:selected").val().split('.');
          var $MainBranchConditon=$("#InsertDecBeforeActWithMainCon").find("option:selected").val().split('.');
          var $SupBranchCondition=$("#InsertDecBeforeActWithSBCon").find("option:selected").val().split('.');
          var $InserActivity=$("#InsertDecBeforeActWithInserAct").find("option:selected").val().split('.');
          var $TargetDecisions=$("#InsertDecBeforeActWithTarDec").find("option:selected").val().split('.');
          var $UseCase=$("#InsertDecBeforeActWithUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
        $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+$TargetDecision[1]+" before "          +$PostActivity[1]+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
          }
       })
          if($ifNone)
          {
            $operation_position="Insert "+$TargetDecision[1]+" before "          +$PostActivity[1]+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
          }
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         
         if($marks){ 
           //window.location.href="/InsertDecBeforeActWith/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartDec+"分"+$PostAct+"分"+$MainBranchCon+"分"+$SupBranchCon+"分"+$InserAct+"分"+$TargetDec+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
            $.ajax({
            type: "POST",
            url: "/InsertDecBeforeActWith",
            data: {
             TartDec:$TartDec,
             PostAct:$PostAct,
             MainBranchCon:$MainBranchCon,
             SupBranchCon:$SupBranchCon,
             InserAct:$InserAct,
             TargetDec:$TargetDec,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
           }
      
      }
    });



     $( "#InsertDecBeforeActCon" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {

            "Confirm": function() {
              
              $( this ).dialog( "close" );
          
        },
      },
      close: function() {
          var $marks=true;
          var $TartDec=$("#InsertDecBeforeActConTar").find("option:selected").val();
          var $PostAct=$("#InsertDecBeforeActConPostAct").find("option:selected").val();
          var $InsertCon=$("#InsertDecBeforeActConInserCon").find("option:selected").val();
          var $MainBranchCon=$("#InsertDecBeforeActConMainCon").find("option:selected").val();
          var $SupBranchCon=$("#InsertDecBeforeActConSBCon").find("option:selected").val();
          var $InserAct=$("#InsertDecBeforeActConInserAct").find("option:selected").val();
          var $TargetDec=$("#InsertDecBeforeActConTarDec").find("option:selected").val();
          var $UC=$("#InsertDecBeforeActConUseCase").find("option:selected").val();
          if($TartDec=="-1"||$PostAct=="-1"||$InsertCon=="-1"||$MainBranchCon=="-1"||$SupBranchCon=="-1"||$InserAct=="-1"||$TartDec=="-1"||$UC=="-1")
            $marks=false;

          var $TargetDecision=$("#InsertDecBeforeActConTar").find("option:selected").val().split('.');
          var $PostActivity=$("#InsertDecBeforeActConPostAct").find("option:selected").val().split('.');
          var $InsertCondition=$("#InsertDecBeforeActConInserCon").find("option:selected").val().split('.');
          var $MainBranchConditon=$("#InsertDecBeforeActConMainCon").find("option:selected").val().split('.');
          var $SupBranchCondition=$("#InsertDecBeforeActConSBCon").find("option:selected").val().split('.');
          var $InserActivity=$("#InsertDecBeforeActConInserAct").find("option:selected").val().split('.');
          var $TargetDecisions=$("#InsertDecBeforeActConTarDec").find("option:selected").val().split('.');
          var $UseCase=$("#InsertDecBeforeActConUseCase").find("option:selected").val().split('.');
        
            $operation_position="";
        var $mark=false;
        var $ifNone=true;
       $(".section_accordion").each(function(){
          $ifNone=false;
          if($(this).attr("id")==$current_accordion)
            $mark=true;

          if($operation_position!="")
            $operation_position=$operation_position+"$";
          $operation_position=$operation_position+$(this).attr("id");

          if($mark){
            $mark=false;
            if($operation_position!="")
              $operation_position=$operation_position+"$";

            $operation_position=$operation_position+"Insert "+$TargetDecision[1]+" before ( "          +$PostActivity[1]+" , "+$InsertCondition[1]+" )"+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
          }
       })
          if($ifNone){
            $operation_position="Insert "+$TargetDecision[1]+" before ( "          +$PostActivity[1]+" , "+$InsertCondition[1]+" )"+" with ( "+$MainBranchConditon[1]+" ),( "+$SupBranchCondition[1]+" , "+$InserActivity[1]+" , "+$TargetDecisions[1]+" ) in "+$UseCase[1];
          }
          $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
         if($marks){
           //window.location.href="/InsertDecBeforeActCon/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$TartDec+"分"+$PostAct+"分"+$InsertCon+"分"+$MainBranchCon+"分"+$SupBranchCon+"分"+$InserAct+"分"+$TargetDec+"分"+$UC+"分"+$operation_position+"分"+$current_guard_id;
           $.ajax({
            type: "POST",
            url: "/InsertDecBeforeActCon",
            data: {
             TartDec:$TartDec,
             PostAct:$PostAct,
             InsertCon:$InsertCon,
             MainBranchCon:$MainBranchCon,
             SupBranchCon:$SupBranchCon,
             InserAct:$InserAct,
             TargetDec:$TargetDec,
             UC:$UC,
             operation_position:$operation_position,
             current_guard_id: $current_guard_id,
             projectID:$("#hidden_project_id").val()
           },
            dataType:'json',
            success:function(Object){
             console.log(Object);
             window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
            },
            error:function(){

            }
          });
         }
      
      }
    });  
var $addTraceRule_selfname;
var $addTraceRule_guardname;
var $operation_position;
var $isAddOrEdit;
 $( "#AddTraceRule" ).dialog({
          autoOpen: false,
          width: 500,
          modal: true,
          resizable: false,
          buttons: {
            
            "Confirm": function() {
              $hidden_fields="";
              $current_guard_id=$(".myInsideA.focusBgColor").attr("name");
              $addTraceRule_selfname=$("#guardselfname").val();
              $addTraceRule_guardname=$("#hidden_guardselfname").val();
              
              if($addTraceRule_guardname=="")
                {
                  alert("Please enter guard name");
                }else{
                  if($addTraceRule_selfname==""){
                    alert("Please enter selfname");
                  }else{
                     $operation_position="";
                    $(".section_accordion").each(function(){
                        if($operation_position!="")
                            $operation_position=$operation_position+"$";

                            $operation_position=$operation_position+$(this).attr("id");

                        })
                    if($isAddOrEdit){
                     // window.location.href="/addTraceRule/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$addTraceRule_selfname+"分"+$addTraceRule_guardname+"分"+$operation_position+"分"+$current_guard_id;
                     console.log("hidden_fields-----------------------------");
                     console.log($hidden_fields);
                     console.log("hidden_fields-----------------------------");
                      $.ajax({
                        type: "POST",
                        url: "/addTraceRule",
                        data: {
                          user:"<%=tracerules[0].user%>",
                          id:$hidden_fields,
                          selfname:$addTraceRule_selfname,
                          guardname:$addTraceRule_guardname,
                          operation_position:$operation_position,
                          current_guard_id:$current_guard_id,
                          projectID:$("#hidden_project_id").val()
                        },
                        dataType:'json',
                        success:function(Object){
                          console.log(Object);
                          window.location.href="/T/"+$("#hidden_project_id").val();
                      },
                        error:function(){
                          console.log("error_T");
                      }
                      });
                    }else{
                     // window.location.href="/editTraceRule/"+"<%=tracerules[0].user%>"+"分<%=tracerules[0]._id%>分"+$addTraceRule_selfname+"分"+$addTraceRule_guardname+"分"+$operation_position+"分"+$current_guard_id;
                      $.ajax({
                        type: "POST",
                        url: "/editTraceRule",
                        data: {
                          user:"<%=tracerules[0].user%>",
                          id:$hidden_fields,
                          selfname:$addTraceRule_selfname,
                          guardname:$addTraceRule_guardname,
                          operation_position:$operation_position,
                          current_guard_id:$current_guard_id,
                          projectID:$("#hidden_project_id").val()
                        },
                        dataType:'json',
                        success:function(Object){
                          console.log(Object);
                          window.location.href="/T/"+$("#hidden_project_id").val()+"_"+$current_guard_id;
                      },
                        error:function(){
                          console.log("error_T");
                      }
                      });

                    }

                    $( this ).dialog( "close" );
                  }
                }
       
          
        },
      },
      close: function() {
        //alert($addTraceRule_selfname+" "+$addTraceRule_guardname);
        
          
        
      }
    });


      $( ".icon-plus-sign" ).click(function() {
        //$("#AddTraceRule").load("/ConfigurationTree");
        $isAddOrEdit=true;
        if(document.getElementById("hidden_guardselfname").value!="")
        {
          var $names=new Array();
          $names=document.getElementById("hidden_guardselfname").value.split("∨");
          for(thenamess in $names)
          {
            if(document.getElementById($names[thenamess]).checked)
            document.getElementById($names[thenamess]).checked=false;
          }
        document.getElementById("AddTraceRule").title="Add New Trace Rule";

        document.getElementById("guardselfname").value="";
        document.getElementById("hidden_guardselfname").value="";
        document.getElementById("AddGuard").innerHTML="<b>Guard:</b>";
        }

        $("#AddTraceRule").dialog("open");
      });

      $(".icon-pencil.editGuard").click(function(){
        $isAddOrEdit=false;
        

        var $hiddenGuardName=$("#hiddenguardname")[0].value;
        var $hiddenSelfName=$("#hiddenselfname")[0].value;
        var $GuardShow=document.getElementById("AddGuard");
        var $temp="";
        
          $("#AddTraceRule").dialog("open");

          document.getElementById("guardselfname").value=$hiddenSelfName;
          document.getElementById("hidden_guardselfname").value=$hiddenGuardName;
          var $names=new Array();
          $names=$hiddenGuardName.split("∨");
          var $markFirst=false;
          $GuardShow.innerHTML="<b>Guard:</b>";
          for(thename in $names){
             if($names[thename].indexOf("¬")>=0){
              var $tempName=$names[thename].replace("¬","");
              document.getElementById($tempName).checked=true;
             }else{
              document.getElementById($names[thename]).checked=true;
            }
            if($markFirst){
              $temp=$temp+"∨";
            }
            $markFirst=true;
            if($names[thename].indexOf("¬")>=0){
              $names[thename]=$names[thename].replace("¬","");
              $temp=$temp+"<a onclick=\"changeState(\'"+$names[thename]+"\')\" style=\"cursor:pointer\" name=\"a_"+$names[thename]+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">¬</font><font color=\"blue\">"+$names[thename]+"</font></a>";
            }else{
              $temp=$temp+"<a onclick=\"changeState(\'"+$names[thename]+"\')\" style=\"cursor:pointer\" name=\"a_"+$names[thename]+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">"+$names[thename]+"</font></a>";
            }
            
          }

          $GuardShow.innerHTML=$GuardShow.innerHTML+$temp;

      })
   

  })
 
 

</script>


<input type="hidden" id="hidden_elementdepencys" value="<%= elementdepencys%>">

<div class="c">
  <input type="hidden" id="hidden_project_id" value="<%=projectID%>">
  <div class="left">
   <div class="myBorderRadiusPlus">
    <div class="titles">
      Trace Rule List
    </div>
    <div class="myh4" style="margin-top:8px">
      
      <ul class="nav nav-list" id="guardlist">
        <%- partial('guardList', {current_guard:current_guard,guardlists:guardlists}) %>
        <li class="nav-list-1"><a href="javascript:;" class="myInsidePlus" style="text-align:center;margin-bottom:0px;vertical-align:middle;"><i class="icon-plus-sign"></i></a></li>
      </ul>


    </div>
   </div>
  </div>
  
  <div class="center" style="min-height:500px">

   <%- partial('operationSequence', {current_guard:current_guard,tracerules:tracerules,elementdepencys: elementdepencys}) %>

  </div>
  

<div class="right" style="min-height:500px">

   <div class="BorderGuard" >
    <div class="titles">
      Dependency
    </div>
    
    <div style="margin-top:8px">
      <%- partial('dependencyShow',{elementdepencys:elementdepencys,current_guard:current_guard,guardLists:guardlists,checkelementdepencys:elementdepencys})%>

    </div>
   </div>

   <div class="BorderGuard" style="margin-top:22px">
    <div class="titles">
      Depended
    </div>
    
    <div style="margin-top:8px">
      <%- partial('toDependencyShow',{elementdepencys:elementdepencys,current_guard:current_guard,guardLists:guardlists,checkelementdepencys:elementdepencys})%>

    </div>
   </div>


  </div>
 <!-- add guard --> 
    <style type="text/css">
      .contact{width:100px;height:15px;margin:20px 0 0 50px;background-color:#CCCCCC;text-align:center;}
      .us{display:none;width:250px;height:20px;padding:10px;position: absolute;background-color:gery;z-index:9999}
    </style>

<div id="AddTraceRule" title="Trace Rule">
  <script>
  setTimeout('load()',100);
    var $mouseX,$mouseY;
     function showTips(){
       var displayTips=document.getElementById("us");
       $mouseX=event.clientX;
       $mouseY=event.clientY;
       //alert(typeof($mouseX)+" "+typeof($mouseY));
       displayTips.style.top=$mouseY+10+"px";
       displayTips.style.left=$mouseX+"px";
       displayTips.style.display="block";
     }

      function hideTips(){
       var displayTips=document.getElementById("us");
       displayTips.style.display="none";
     }

     function changeState(id){
        var $ids="a_"+id;

        var $ID=document.getElementsByName($ids);

        var $State=$ID[0].innerHTML;
        var $state1=id;
        var $state2="¬"+id;
        if($State.indexOf("<font color=\"blue\">¬</font>")>=0){
          $State=$State.replace("<font color=\"blue\">¬</font>","");
          $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($state2,$state1);
        }else{
          $State="<font color=\"blue\">¬</font>"+$State;
          $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($state1,$state2);
        }
        $ID[0].innerHTML=$State;
     }

     function addGuard(check_id){
      
      var $CheckBoxGuard=document.getElementById(check_id);
      var $GuardShow=document.getElementById("AddGuard");
      var $temp;
          
       
          if($CheckBoxGuard.checked==true){
            console.log("$GuardShow.innerHTML:"+$GuardShow);
            console.log("length:"+$GuardShow.length);
            if($GuardShow.innerHTML.length>21){
                $temp="∨<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">"+check_id+"</font></a>";
                $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname").attr("value")+"∨"+check_id;
            }else{
                $temp="<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">"+check_id+"</font></a>";
                $("#hidden_guardselfname")[0].value=check_id;
            }
            $GuardShow.innerHTML=$GuardShow.innerHTML+$temp;

          }else{
            $temp="∨<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">"+check_id+"</font></a>";
            var $temps=$GuardShow.innerHTML;
            var $hiddenGuard
            if($temps.indexOf($temp)>=0){
              
                $temps=$temps.replace($temp,"");

                $hiddenGuard="∨"+check_id;
                $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($hiddenGuard,"");
            }else{
              

                $temp="<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">"+check_id+"</font></a>";
                $hiddenGuard=check_id;
               if($temps.indexOf($temp)>=0){
                $temps=$temps.replace($temp,"");
                $temps=$temps.replace("∨","");
                $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($hiddenGuard,"");
                $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace("∨","");
              }else{
                $temp="∨<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">¬</font><font color=\"blue\">"+check_id+"</font></a>";
                if($temps.indexOf($temp)>=0){
                  $temps=$temps.replace($temp,"");
                  $hiddenGuard="∨¬"+check_id;
                  $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($hiddenGuard,"");
                }
                else{
                  $temp="<a onclick=\"changeState(\'"+check_id+"\')\" style=\"cursor:pointer\" name=\"a_"+check_id+"\" onmouseover=\"showTips()\" onmouseout=\"hideTips()\"><font color=\"blue\">¬</font><font color=\"blue\">"+check_id+"</font></a>";
                    $temps=$temps.replace($temp,"");
                    $temps=$temps.replace("∨","");
                    $hiddenGuard="¬"+check_id;
                    $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace($hiddenGuard,"");
                    $("#hidden_guardselfname")[0].value=$("#hidden_guardselfname")[0].value.replace("∨","");
                }
              }
            }
            
            $GuardShow.innerHTML=$temps;
          }

    
     }
  </script>
  <div id="AddGuard">
    <b>Guard:</b>
  </div>
  <form class="form-horizontal">
  <div id="AddSelfname" style="margin-top:10px;">
    <b>Selfname:&nbsp;</b>
    <input id="guardselfname" style="width:60%;height:18px">
    <input type="hidden" id="hidden_guardselfname" value="">
  </div>
  </form>
  <HR style="FILTER: progid:DXImageTransform.Microsoft.Glow(color=#987cb9,strength=10)" width="100%" color=#987cb9 SIZE=1>
  <script src="/javascripts/fmtreeForTraceability.js"></script>
  
  <form>
    <script src="/javascripts/loadFMTreeForTraceability.js"></script>
  </form>

</div>

<div class="us" id="us">Click to change the state of this feature</div>

 <!-- 编辑guard自定义名字 --> 
<div id="editSelfName" title="Edit Name">
  
  <form>
    <fieldset id="dialog-exchange">
       <label class="control-label" for="selfname">Guard Name：</label>
        <input type="text" class="input-xlarge" id="selfname" name="selfname">
    </fieldset>
  </form>

</div>

 <!-- 确定是否删除 --> 
<div id="confirmDelete" title="Confirm Delete">
  
  <form>
    <fieldset id="dialog-exchange">
       <label class="control-label" > Confirm Delete? </label>
        
    </fieldset>
  </form>

</div>


<!-- 增加操作 --> 
<div id="addOperation" title="Create Operation">
  
  <form>
    <fieldset id="dialog-exchange">
       <label class="control-label" for="selfname"><h4>choose the TDL type：</h4></label>
       <div style="margin-left:5%">

        <HR style="FILTER: progid:DXImageTransform.Microsoft.Glow(color=#987cb9,strength=10)" width="100%" color=#987cb9 SIZE=1>

          <label class="radio">
            <input type="radio" name="TDLType" id="Create" value="Create" style="margin-top:11px">
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create &nbsp;&nbsp;
            <select style="width:48%" class="SubTDLType" disabled=true>
              <option value="C1">Use case</option>
              <option value="C2">Activity</option>
              <option value="C3">Decision</option>
              <option value="C4">Condition</option>
            </select>
        </label>
        <HR style="FILTER: progid:DXImageTransform.Microsoft.Glow(color=#987cb9,strength=10)" width="100%" color=#987cb9 SIZE=1>
        <label class="radio">
          <input type="radio" name="TDLType" id="InserSeq" value="InserSeq" style="margin-top:12px">
            &nbsp;&nbsp; Insert <b>activity</b> &nbsp;
            <select style="width:48%" class="SubTDLType" disabled=true>
            <!--  <option value="I1">between pre-activity, post-activity</option>  -->
              <option value="I2">after pre-activity</option>
              <option value="I3">before post-activity</option>
              <option value="I4">after decision, condition</option>
              <option value="I5">before activity, condition</option>
            </select>
            &nbsp;&nbsp;&nbsp;in <b>use case</b>
        </label>
        <HR style="FILTER: progid:DXImageTransform.Microsoft.Glow(color=#987cb9,strength=10)" width="100%" color=#987cb9 SIZE=1>
           <label class="radio">
          <input type="radio" name="TDLType" id="InserDec" value="InserDec" style="margin-top:11px">
          &nbsp; Insert <b>decision</b> &nbsp;
          <select style="width:48%;margin-left:-3px" class="SubTDLType" disabled=true>
            <option value="I6">after pre-activity</option>
            <option value="I7">after decision,condition</option>
            <option value="I8">before post-activity</option>
            <option value="I9">before post-activity with condition</option>
            <option value="I10">before post-activity,condition</option>
          </select>
          &nbsp;&nbsp;&nbsp;in <b>use case</b>
        </label>
      </div>
    </fieldset>
  </form>

</div>

 <!-- Create Activity --> 
<div id="CreateActivity" title="Create Activity">
  
   <form class="form-horizontal">
    <div class="control-group">
      <label class="control-label" for="activityname">Name:</label>
        <div class="controls">
          <input type="text" id="activityname" style="width:100" placeholder="">
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="activitydescription">Description:</label>
        <div class="controls">
          <textarea id="activitydescription" rows="3" cols="10" style="resize:none"></textarea>
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="activityexecutor">Executor:</label>
        <div class="controls">        
            <input type="radio" name="ExecutorType" id="Executor1" value="System" checked>
            System
            &nbsp;&nbsp;
            <input type="radio" name="ExecutorType" id="Executor2" value="User">
            User          
        </div>
    </div>
   </form>

</div>

 <!-- Create Use Case --> 
<div id="CreateUseCase" title="Create Use Case">
  
   <form class="form-horizontal">
    <div class="control-group">
      <label class="control-label" for="usecasename">Name:</label>
        <div class="controls">
          <input type="text" id="usecasename" style="width:100" placeholder="">
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="usecasedescription">Description:</label>
        <div class="controls">
          <textarea id="usecasedescription" rows="3" cols="10" style="resize:none"></textarea>
        </div>
    </div>
   </form>

</div>

<!-- Create Decision --> 
<div id="CreateDecision" title="Create Decision">
  
   <form class="form-horizontal">
    <div class="control-group">
      <label class="control-label" for="decisionname">Name:</label>
        <div class="controls">
          <input type="text" id="decisionname" style="width:100" placeholder="">
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="decisiondescription">Description:</label>
        <div class="controls">
          <textarea id="decisiondescription" rows="3" cols="10" style="resize:none"></textarea>
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="decisionexecutor">Executor:</label>
        <div class="controls">        
            <input type="radio" name="DecisionExecutorType" id="Executor1" value="System" checked>
            System
            &nbsp;&nbsp;
            <input type="radio" name="DecisionExecutorType" id="Executor2" value="User">
            User          
        </div>
    </div>
   </form>

</div>

 <!-- Create Condition --> 
<div id="CreateCondition" title="Create Condition">
  
   <form class="form-horizontal">
    <div class="control-group">
      <label class="control-label" for="conditionname">Name:</label>
        <div class="controls">
          <input type="text" id="conditionname" style="width:100" placeholder="">
        </div>
    </div>
    <div class="control-group">
      <label class="control-label" for="conditiondescription">Description:</label>
        <div class="controls">
          <textarea id="conditiondescription" rows="3" cols="10" style="resize:none"></textarea>
        </div>
    </div>
   </form>

</div>



<!-- Insert activity after pre-activity in use case-->
 
<div id="InsertActAfterPre" title="Insert Activity After Pre Activity">
  <!--
  <%- partial('InsertActAfterPre', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->

</div>

<!-- Insert activity before post-activity in use case-->
 
<div id="InsertActBeforePost" title="Insert Activity Before Post Activity">
  <!--
  <%- partial('InsertActBeforePost', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>

<!-- Insert activity after decision condition in use case-->
 
<div id="InsertActAfterDecCon" title="Insert Activity After Decision Condition">
  <!--
  <%- partial('InsertActAfterDecCon', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>

<!-- Insert activity after activity condition in use case-->
 
<div id="InsertActBeforeActCon" title="Insert Activity After Activty Condition">
  <!--
  <%- partial('InsertActBeforeActCon', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>



<!-- Insert decision before activity with condition acitivty, condition in use case-->
 
<div id="InsertDecBeforeAct" title="Insert Decision Before Activity with Condition Activity">
  <!--
  <%- partial('InsertDecBeforeAct', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>
<!-- Insert decision before activity with condition in use case-->
 
<div id="InsertDecBeforeActWith" title="Insert Decision Before Activty with Condition">
  <!--
  <%- partial('InsertDecBeforeActWith', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>

<!-- Insert decision after activity with condition in use case-->
 
<div id="InsertDecAfterAct" title="Insert Decision After Activty with Condition">
  <!--
  <%- partial('InsertDecAfterAct', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>
<!-- Insert decision after decision,conditon with condition in use case-->
 
<div id="InsertDecAfterDecCon" title="Insert Decision After Decision,Condition with Condition">
  <!--
  <%- partial('InsertDecAfterDecCon', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>
<!-- Insert decision before activity condition with condition in use case-->
 
<div id="InsertDecBeforeActCon" title="Insert Decision Before Activty Condition">
  <!--
  <%- partial('InsertDecBeforeActCon', { elementdepencys:elementdepencys,current_guard:current_guard}) %>
  -->
</div>
